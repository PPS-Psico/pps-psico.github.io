import{cv as $,r as p,cw as _,cx as d,T as P,cy as M,cz as R,cA as O,cB as D,j as e,C as x}from"./index-ZXlslG1z.js";const h=(s,r,c,m)=>{$.event({action:s,category:r,label:c,value:m})},N={studentRegistration:s=>{h("student_registered","academic",`${s.legajo} - ${s.orientation}`)},practiceSubmission:s=>{h("practice_submitted","academic",`${s.institution} - ${s.type}`,s.hours)},convocatoriaApplication:s=>{h("convocatoria_applied","academic",`${s.name} - ${s.orientation}`)},reportSubmission:s=>{h("report_submitted","academic",`${s.type} - ${s.practiceId}`)},login:s=>{h("user_login","authentication",s)},logout:s=>{h("user_logout","authentication",s)},featureUsed:(s,r)=>{h("feature_used","engagement",r?`${s} - ${r}`:s)},errorOccurred:(s,r)=>{h("error_occurred","error",`${s} - ${r}`)},performanceMetric:(s,r)=>{h("performance_metric","performance",s,r)}},U=()=>{const[s,r]=p.useState({status:"healthy",checks:{database:!1,supabaseAuth:!1,cache:!1,api:!1,storage:!1},lastCheck:new Date,uptime:0,version:"1.0.0"}),[c,m]=p.useState({activeUsers:0,requestCount:0,errorRate:0,avgResponseTime:0,memoryUsage:0,cpuUsage:0}),[b,y]=p.useState(!1),f=async()=>{try{const t=performance.now(),{error:n}=await P.from("estudiantes").select("count(*)",{count:"exact",head:!0}).limit(1),l=performance.now()-t;return _("database_health_check",l,{success:!n,responseTime:l}),!n&&l<2e3}catch(t){return d(t,{context:"database_health_check"}),!1}},v=async()=>{try{const t=performance.now();await P.auth.getSession();const i=performance.now()-t;return _("supabase_auth_health_check",i,{success:!0,responseTime:i}),i<1e3}catch(t){return d(t,{context:"supabase_auth_health_check"}),!1}},j=async()=>{try{const t=performance.now(),n=await fetch("/health",{method:"GET",cache:"no-cache"}),l=performance.now()-t;return _("api_health_check",l,{success:n.ok,status:n.status,responseTime:l}),n.ok&&l<1e3}catch(t){return d(t,{context:"api_health_check"}),!1}},w=()=>{try{const t="health_check_test",n=Date.now().toString();localStorage.setItem(t,n);const i=localStorage.getItem(t);return localStorage.removeItem(t),i===n}catch(t){return d(t,{context:"cache_health_check"}),!1}},T=()=>{try{const t={test:"health_check",timestamp:Date.now()};localStorage.setItem("health_test",JSON.stringify(t));const n=JSON.parse(localStorage.getItem("health_test")||"{}");return localStorage.removeItem("health_test"),n.test===t.test}catch(t){return d(t,{context:"storage_health_check"}),!1}},u=async()=>{const t=performance.now();try{const[n,i,l,C,A]=await Promise.all([f(),v(),j(),Promise.resolve(w()),Promise.resolve(T())]),E=performance.now()-t;_("full_health_check",E,{database:n,auth:i,api:l,cache:C,storage:A});const S={database:n,supabaseAuth:i,cache:C,api:l,storage:A},I=Object.values(S).filter(H=>!H).length;let g;return I===0?g="healthy":I<=2?g="warning":g="critical",r({status:g,checks:S,lastCheck:new Date,uptime:performance.now()/1e3,version:"1.0.0"}),{status:g,checks:S,responseTime:E}}catch(n){return d(n,{context:"run_health_check"}),r(i=>({...i,status:"critical",lastCheck:new Date})),{status:"critical",checks:{},responseTime:0}}},k=async()=>{try{const t=performance.memory;m({activeUsers:Math.floor(Math.random()*100)+20,requestCount:Math.floor(Math.random()*1e3)+500,errorRate:Math.random()*5,avgResponseTime:Math.random()*500+100,memoryUsage:t?t.usedJSHeapSize/t.totalJSHeapSize*100:0,cpuUsage:Math.random()*80})}catch(t){d(t,{context:"collect_metrics"})}};return{health:s,metrics:c,isMonitoring:b,runHealthCheck:u,startMonitoring:()=>{y(!0),u(),k();const t=setInterval(u,3e4),n=setInterval(k,1e4);return()=>{clearInterval(t),clearInterval(n)}},stopMonitoring:()=>{y(!1)},getStatusColor:t=>{switch(t){case"healthy":return"text-green-600";case"warning":return"text-yellow-600";case"critical":return"text-red-600";default:return"text-gray-600"}},getStatusIcon:t=>{switch(t){case"healthy":return"‚úÖ";case"warning":return"‚ö†Ô∏è";case"critical":return"‚ùå";default:return"‚ùì"}}}},W=()=>{const[s,r]=p.useState({}),[c,m]=p.useState(!1),{health:b,runHealthCheck:y}=U(),f=()=>{try{throw new Error("Error de prueba para Sentry")}catch(a){d(a,{component:"MonitoringTest",action:"testErrorTracking",testMode:!0}),r(o=>({...o,errorTracking:"‚úÖ Error enviado a Sentry"}))}},v=()=>{N.studentRegistration({legajo:"TEST-001",orientation:"Psicolog√≠a Cl√≠nica"}),N.practiceSubmission({hours:120,institution:"Hospital de Prueba",type:"Cl√≠nica"}),N.featureUsed("monitoring_test","test_component"),r(a=>({...a,analytics:"‚úÖ Eventos enviados a GA4"}))},j=async()=>{const a=await O("test_operation",async()=>(await new Promise(o=>setTimeout(o,1e3)),"Operaci√≥n completada"));r(o=>({...o,performance:`‚úÖ Performance medido: ${a}ms`}))},w=async()=>{try{await R(async()=>(await fetch("https://jsonplaceholder.typicode.com/posts/1")).json(),"test_api_call"),r(a=>({...a,api:"‚úÖ API call monitoreado exitosamente"}))}catch(a){d(a,{context:"test_api_call"}),r(o=>({...o,api:"‚ùå Error en API call (registrado)"}))}},T=()=>{const a=M();r(o=>({...o,webVitals:{status:"‚úÖ Web Vitals obtenidos",data:a}}))},u=async()=>{const a=await y();r(o=>({...o,health:{status:"‚úÖ Health checks ejecutados",result:a}}))},k=async()=>{m(!0),r({}),f(),await new Promise(a=>setTimeout(a,500)),v(),await new Promise(a=>setTimeout(a,500)),await j(),await new Promise(a=>setTimeout(a,500)),await w(),await new Promise(a=>setTimeout(a,500)),T(),await new Promise(a=>setTimeout(a,500)),await u(),m(!1)};return p.useEffect(()=>{console.log("üß™ Monitoring Test Component Loaded"),console.log("üìä Available monitoring functions:",{trackError:typeof d,trackAcademicEvents:typeof N,measurePerformance:typeof O,monitorAPICall:typeof R,getWebVitalsData:typeof M}),D("Monitoring Test Component initialized","info")},[]),e.jsxs("div",{className:"p-6 max-w-4xl mx-auto space-y-6",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"üß™ Monitoring y Analytics Test Suite"}),e.jsx("p",{className:"text-gray-600",children:"Prueba todas las funcionalidades de monitoring implementadas"})]}),e.jsxs(x,{className:"p-6 bg-blue-50 border-blue-200",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Estado Actual del Sistema"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Health Status:"}),e.jsx("div",{className:b.status==="healthy"?"text-green-600":"text-red-600",children:b.status.toUpperCase()})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Environment:"}),e.jsx("div",{children:"production"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Monitoring:"}),e.jsx("div",{children:"‚úÖ Enabled"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Timestamp:"}),e.jsx("div",{children:new Date().toLocaleTimeString()})]})]})]}),e.jsxs(x,{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Controles de Prueba"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6",children:[e.jsx("button",{onClick:f,disabled:c,className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700 disabled:opacity-50",children:"üö® Test Error Tracking"}),e.jsx("button",{onClick:v,disabled:c,className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 disabled:opacity-50",children:"üìä Test Analytics"}),e.jsx("button",{onClick:j,disabled:c,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50",children:"‚ö° Test Performance"}),e.jsx("button",{onClick:w,disabled:c,className:"px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700 disabled:opacity-50",children:"üåê Test API Monitoring"}),e.jsx("button",{onClick:T,disabled:c,className:"px-4 py-2 bg-yellow-600 text-white rounded hover:bg-yellow-700 disabled:opacity-50",children:"üìà Test Web Vitals"}),e.jsx("button",{onClick:u,disabled:c,className:"px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700 disabled:opacity-50",children:"üîç Test Health Checks"})]}),e.jsx("button",{onClick:k,disabled:c,className:"w-full px-6 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg font-semibold hover:from-blue-700 hover:to-purple-700 disabled:opacity-50",children:c?"üîÑ Running All Tests...":"üöÄ Run All Tests"})]}),Object.keys(s).length>0&&e.jsxs(x,{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Resultados de Pruebas"}),e.jsx("div",{className:"space-y-3",children:Object.entries(s).map(([a,o])=>e.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded",children:[e.jsxs("span",{className:"font-medium capitalize",children:[a.replace(/([A-Z])/g," $1").trim(),":"]}),e.jsx("div",{className:"text-sm",children:typeof o=="string"?o:JSON.stringify(o,null,2)})]},a))})]}),e.jsxs(x,{className:"p-6 bg-yellow-50 border-yellow-200",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"üìã Instrucciones de Verificaci√≥n"}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"1. Sentry:"})," Abre tu proyecto en Sentry.io y verifica que aparezcan los errores de prueba"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"2. Google Analytics:"})," Ve a Analytics > Real-time y observa los eventos"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"3. Console:"})," Revisa la consola del navegador por logs de monitoring"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"4. Network:"})," En DevTools > Network, busca llamadas a google-analytics.com y sentry.io"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"5. Performance:"})," En DevTools > Performance, analiza las m√©tricas"]})]})]}),e.jsxs(x,{className:"p-6 bg-gray-50",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"üîß Informaci√≥n de Entorno"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"SENTRY_DSN:"})," ","‚ùå No configurado"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"GA4_MEASUREMENT_ID:"})," ","‚ùå No configurado"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"PRODUCTION:"})," ","‚úÖ S√≠"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"MONITORING_ENABLED:"})," ","‚úÖ S√≠"]})]})]})]})};export{W as default};
