import{O as X,Q as N,T as p,U as B,V as E,W as H,X as Y,Y as _,p as w,Z as Q,_ as J,h as M,K as P,k as G,n as L,$ as I,E as O,z as F,a0 as W,G as R,F as T,a1 as $,a2 as K,a3 as S,R as ee,j as n,u as U,r as te,a4 as ae,N as ne,a5 as re,M as se}from"./index-ZXlslG1z.js";import{t as v,c as ie,n as C,g as z,m as q,a as j,d as oe}from"./differenceInDays-B0Mox2cD.js";const de=(e=!1)=>X({queryKey:["operationalData",e],queryFn:async()=>{const r=new Date,t=r.getFullYear();r.setHours(0,0,0,0);let s=[],a=[],f=[];if(e)s=await N.getAll("lanzamientos_pps"),a=await N.getAll("solicitudes_pps"),f=await N.getAll("finalizacion_pps");else{const[i,l,m]=await Promise.all([p.from(B).select(`*, ${E}`),p.from(H).select("*"),p.from(Y).select("*").eq(_,"Pendiente")]);s=i.data||[],a=l.data||[],f=m.data||[]}const d=s.map(i=>{const l=w(i[Q]),m=l?Math.ceil((l.getTime()-r.getTime())/(1e3*60*60*24)):999;return{...i,daysLeft:m,estado_gestion:i[J]||"Pendiente de Gestión",notas_gestion:i[E]}}).filter(i=>{const l=w(i[M]);if(!l||l.getUTCFullYear()!==t)return!1;const m=i.estado_gestion;return m==="Relanzamiento Confirmado"||m==="Archivado"||m==="No se Relanza"?!1:i.daysLeft<0||i.daysLeft<=30}),o=["finalizada","cancelada","rechazada","archivado","pps realizada","realizada","no se pudo concretar"],u=a.map(i=>({...i,updated:i[G]||i.created_at,estado_seguimiento:i[P]})).filter(i=>{const l=L(i.estado_seguimiento);return!o.includes(l)}),c=f.filter(i=>i[_]==="Pendiente"),g=s.filter(i=>{const l=L(i.estado_convocatoria);if(l!=="abierta"&&l!=="abierto")return!1;let m=w(i[I]);return m||(m=w(i[M])),m?Math.ceil((m.getTime()-r.getTime())/(1e3*60*60*24))<=2:!1}).map(i=>{const l=w(i[I])||w(i[M]),m=l?Math.ceil((l.getTime()-r.getTime())/(1e3*60*60*24)):0;return{id:i.id,name:i.nombre_pps||"Convocatoria sin nombre",daysRemaining:m,closingDate:i[I]||i[M],isClosingToday:m===0}});return{endingLaunches:d,pendingRequests:u,pendingFinalizations:c,closingAlerts:g}}}),V=e=>!e||e.toLowerCase().trim()==="pendiente"?"Pendiente":e,le=(e=!1)=>X({queryKey:["activityFeed",e],queryFn:async()=>{const r=[],t=new Date,s=new Date(t.getTime()-1440*60*1e3);try{let a=[],f=[],d=[];const o={};if(e)a=await N.getAll("solicitudes_pps"),f=await N.getAll("finalizacion_pps"),d=await N.getAll("lanzamientos_pps"),d.forEach(u=>{o[u.id]=Math.floor(Math.random()*5)});else if(a=(await p.from(H).select(`id, created_at, ${O}, ${F}, ${P}`).neq(P,"Archivado").order("created_at",{ascending:!1}).limit(10)).data||[],f=(await p.from(Y).select(`
                            id, 
                            created_at, 
                            ${W}, 
                            ${_}, 
                            estudiante:estudiantes!fk_finalizacion_estudiante (
                                ${R}
                            )
                        `).order("created_at",{ascending:!1}).limit(10)).data||[],d=(await p.from(B).select(`id, created_at, ${T}, ${$}`).eq($,"Abierta").order("created_at",{ascending:!1}).limit(5)).data||[],d.length>0){const i=d.map(m=>m.id),{data:l}=await p.from(K).select(S).in(S,i);l&&l.forEach(m=>{let h=m[S];Array.isArray(h)&&(h=h[0]),h&&(o[h]=(o[h]||0)+1)})}return a.forEach(u=>{let c=u[P]||"Pendiente";if(c=V(c),c==="Archivado")return;const g=u[O]||u.nombre_alumno||"Estudiante",i=u[F]||u.nombre_institucion||"Institución";let l=new Date(u.created_at||Date.now());isNaN(l.getTime())&&(l=new Date);let m="blue";c==="Pendiente"?m="amber":c==="Realizada"?m="purple":["Rechazada","Cancelada","No se pudo concretar"].includes(c)&&(m="rose"),r.push({id:`req-${u.id}`,type:"request",title:"Solicitud de Inicio",description:c,timestamp:l,user:g,avatarLetter:g.charAt(0).toUpperCase(),statusColor:m,rawStatus:c,institution:i,isNew:l>s&&c==="Pendiente"})}),f.forEach(u=>{const c=Array.isArray(u.estudiante)?u.estudiante[0]:u.estudiante,g=(c==null?void 0:c[R])||"Estudiante";let i=u[_]||"Pendiente";i=V(i);const l=u[W]||u.created_at;let m=new Date(l||Date.now());isNaN(m.getTime())&&(m=new Date);const h=i==="Pendiente";r.push({id:`fin-${u.id}`,type:"finalization",title:"Solicita Acreditación",description:h?"Documentación lista":`Estado: ${i}`,timestamp:m,user:g,avatarLetter:g.charAt(0).toUpperCase(),statusColor:h?"emerald":"blue",rawStatus:i,isNew:m>s&&h})}),d.forEach(u=>{const c=u[T]||"Nueva Convocatoria";let g=new Date(u.created_at||Date.now());isNaN(g.getTime())&&(g=new Date);const i=o[u.id]||0;r.push({id:`lanz-${u.id}`,type:"launch",title:"Convocatoria Abierta",description:"Inscripciones habilitadas",timestamp:g,user:c,avatarLetter:c.charAt(0).toUpperCase(),statusColor:"indigo",rawStatus:"Abierta",isNew:g>s,metadata:{count:i}})}),r.sort((u,c)=>c.timestamp.getTime()-u.timestamp.getTime())}catch(a){return console.error("Activity Feed Critical Error:",a),[]}},refetchInterval:1e4,refetchOnWindowFocus:!0});let ce={};function ue(){return ce}function D(e,r){const t=+v(e)-+v(r);return t<0?-1:t>0?1:t}function me(e){return ie(e,Date.now())}function he(e,r,t){const[s,a]=C(t==null?void 0:t.in,e,r),f=s.getFullYear()-a.getFullYear(),d=s.getMonth()-a.getMonth();return f*12+d}function fe(e){return r=>{const s=(e?Math[e]:Math.trunc)(r);return s===0?0:s}}function ge(e,r){return+v(e)-+v(r)}function be(e,r){const t=v(e);return t.setHours(23,59,59,999),t}function xe(e,r){const t=v(e),s=t.getMonth();return t.setFullYear(t.getFullYear(),s+1,0),t.setHours(23,59,59,999),t}function pe(e,r){const t=v(e);return+be(t)==+xe(t)}function ve(e,r,t){const[s,a,f]=C(t==null?void 0:t.in,e,e,r),d=D(a,f),o=Math.abs(he(a,f));if(o<1)return 0;a.getMonth()===1&&a.getDate()>27&&a.setDate(30),a.setMonth(a.getMonth()-d*o);let u=D(a,f)===-d;pe(s)&&o===1&&D(s,f)===1&&(u=!1);const c=d*(o-+u);return c===0?0:c}function ye(e,r,t){const s=ge(e,r)/1e3;return fe(t==null?void 0:t.roundingMethod)(s)}const we={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Ne=(e,r,t)=>{let s;const a=we[e];return typeof a=="string"?s=a:r===1?s=a.one:s=a.other.replace("{{count}}",r.toString()),t!=null&&t.addSuffix?t.comparison&&t.comparison>0?"in "+s:s+" ago":s};function k(e){return(r={})=>{const t=r.width?String(r.width):e.defaultWidth;return e.formats[t]||e.formats[e.defaultWidth]}}const ke={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Me={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},je={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Ae={date:k({formats:ke,defaultWidth:"full"}),time:k({formats:Me,defaultWidth:"full"}),dateTime:k({formats:je,defaultWidth:"full"})},Pe={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},De=(e,r,t,s)=>Pe[e];function b(e){return(r,t)=>{const s=t!=null&&t.context?String(t.context):"standalone";let a;if(s==="formatting"&&e.formattingValues){const d=e.defaultFormattingWidth||e.defaultWidth,o=t!=null&&t.width?String(t.width):d;a=e.formattingValues[o]||e.formattingValues[d]}else{const d=e.defaultWidth,o=t!=null&&t.width?String(t.width):e.defaultWidth;a=e.values[o]||e.values[d]}const f=e.argumentCallback?e.argumentCallback(r):r;return a[f]}}const _e={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Ie={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Se={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Te={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Ce={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Ee={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Le=(e,r)=>{const t=Number(e),s=t%100;if(s>20||s<10)switch(s%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},Oe={ordinalNumber:Le,era:b({values:_e,defaultWidth:"wide"}),quarter:b({values:Ie,defaultWidth:"wide",argumentCallback:e=>e-1}),month:b({values:Se,defaultWidth:"wide"}),day:b({values:Te,defaultWidth:"wide"}),dayPeriod:b({values:Ce,defaultWidth:"wide",formattingValues:Ee,defaultFormattingWidth:"wide"})};function x(e){return(r,t={})=>{const s=t.width,a=s&&e.matchPatterns[s]||e.matchPatterns[e.defaultMatchWidth],f=r.match(a);if(!f)return null;const d=f[0],o=s&&e.parsePatterns[s]||e.parsePatterns[e.defaultParseWidth],u=Array.isArray(o)?We(o,i=>i.test(d)):Fe(o,i=>i.test(d));let c;c=e.valueCallback?e.valueCallback(u):u,c=t.valueCallback?t.valueCallback(c):c;const g=r.slice(d.length);return{value:c,rest:g}}}function Fe(e,r){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&r(e[t]))return t}function We(e,r){for(let t=0;t<e.length;t++)if(r(e[t]))return t}function Z(e){return(r,t={})=>{const s=r.match(e.matchPattern);if(!s)return null;const a=s[0],f=r.match(e.parsePattern);if(!f)return null;let d=e.valueCallback?e.valueCallback(f[0]):f[0];d=t.valueCallback?t.valueCallback(d):d;const o=r.slice(a.length);return{value:d,rest:o}}}const Re=/^(\d+)(th|st|nd|rd)?/i,$e=/\d+/i,ze={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},qe={any:[/^b/i,/^(a|c)/i]},Ve={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Xe={any:[/1/i,/2/i,/3/i,/4/i]},Be={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},He={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Ye={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Ue={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Ze={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Qe={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Je={ordinalNumber:Z({matchPattern:Re,parsePattern:$e,valueCallback:e=>parseInt(e,10)}),era:x({matchPatterns:ze,defaultMatchWidth:"wide",parsePatterns:qe,defaultParseWidth:"any"}),quarter:x({matchPatterns:Ve,defaultMatchWidth:"wide",parsePatterns:Xe,defaultParseWidth:"any",valueCallback:e=>e+1}),month:x({matchPatterns:Be,defaultMatchWidth:"wide",parsePatterns:He,defaultParseWidth:"any"}),day:x({matchPatterns:Ye,defaultMatchWidth:"wide",parsePatterns:Ue,defaultParseWidth:"any"}),dayPeriod:x({matchPatterns:Ze,defaultMatchWidth:"any",parsePatterns:Qe,defaultParseWidth:"any"})},Ge={code:"en-US",formatDistance:Ne,formatLong:Ae,formatRelative:De,localize:Oe,match:Je,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Ke(e,r,t){const s=ue(),a=(t==null?void 0:t.locale)??s.locale??Ge,f=2520,d=D(e,r);if(isNaN(d))throw new RangeError("Invalid time value");const o=Object.assign({},t,{addSuffix:t==null?void 0:t.addSuffix,comparison:d}),[u,c]=C(t==null?void 0:t.in,...d>0?[r,e]:[e,r]),g=ye(c,u),i=(z(c)-z(u))/1e3,l=Math.round((g-i)/60);let m;if(l<2)return t!=null&&t.includeSeconds?g<5?a.formatDistance("lessThanXSeconds",5,o):g<10?a.formatDistance("lessThanXSeconds",10,o):g<20?a.formatDistance("lessThanXSeconds",20,o):g<40?a.formatDistance("halfAMinute",0,o):g<60?a.formatDistance("lessThanXMinutes",1,o):a.formatDistance("xMinutes",1,o):l===0?a.formatDistance("lessThanXMinutes",1,o):a.formatDistance("xMinutes",l,o);if(l<45)return a.formatDistance("xMinutes",l,o);if(l<90)return a.formatDistance("aboutXHours",1,o);if(l<q){const h=Math.round(l/60);return a.formatDistance("aboutXHours",h,o)}else{if(l<f)return a.formatDistance("xDays",1,o);if(l<j){const h=Math.round(l/q);return a.formatDistance("xDays",h,o)}else if(l<j*2)return m=Math.round(l/j),a.formatDistance("aboutXMonths",m,o)}if(m=ve(c,u),m<12){const h=Math.round(l/j);return a.formatDistance("xMonths",h,o)}else{const h=m%12,y=Math.trunc(m/12);return h<3?a.formatDistance("aboutXYears",y,o):h<9?a.formatDistance("overXYears",y,o):a.formatDistance("almostXYears",y+1,o)}}function et(e,r){return Ke(e,me(e),r)}const tt={lessThanXSeconds:{one:"menos de un segundo",other:"menos de {{count}} segundos"},xSeconds:{one:"1 segundo",other:"{{count}} segundos"},halfAMinute:"medio minuto",lessThanXMinutes:{one:"menos de un minuto",other:"menos de {{count}} minutos"},xMinutes:{one:"1 minuto",other:"{{count}} minutos"},aboutXHours:{one:"alrededor de 1 hora",other:"alrededor de {{count}} horas"},xHours:{one:"1 hora",other:"{{count}} horas"},xDays:{one:"1 día",other:"{{count}} días"},aboutXWeeks:{one:"alrededor de 1 semana",other:"alrededor de {{count}} semanas"},xWeeks:{one:"1 semana",other:"{{count}} semanas"},aboutXMonths:{one:"alrededor de 1 mes",other:"alrededor de {{count}} meses"},xMonths:{one:"1 mes",other:"{{count}} meses"},aboutXYears:{one:"alrededor de 1 año",other:"alrededor de {{count}} años"},xYears:{one:"1 año",other:"{{count}} años"},overXYears:{one:"más de 1 año",other:"más de {{count}} años"},almostXYears:{one:"casi 1 año",other:"casi {{count}} años"}},at=(e,r,t)=>{let s;const a=tt[e];return typeof a=="string"?s=a:r===1?s=a.one:s=a.other.replace("{{count}}",r.toString()),t!=null&&t.addSuffix?t.comparison&&t.comparison>0?"en "+s:"hace "+s:s},nt={full:"EEEE, d 'de' MMMM 'de' y",long:"d 'de' MMMM 'de' y",medium:"d MMM y",short:"dd/MM/y"},rt={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},st={full:"{{date}} 'a las' {{time}}",long:"{{date}} 'a las' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},it={date:k({formats:nt,defaultWidth:"full"}),time:k({formats:rt,defaultWidth:"full"}),dateTime:k({formats:st,defaultWidth:"full"})},ot={lastWeek:"'el' eeee 'pasado a la' p",yesterday:"'ayer a la' p",today:"'hoy a la' p",tomorrow:"'mañana a la' p",nextWeek:"eeee 'a la' p",other:"P"},dt={lastWeek:"'el' eeee 'pasado a las' p",yesterday:"'ayer a las' p",today:"'hoy a las' p",tomorrow:"'mañana a las' p",nextWeek:"eeee 'a las' p",other:"P"},lt=(e,r,t,s)=>r.getHours()!==1?dt[e]:ot[e],ct={narrow:["AC","DC"],abbreviated:["AC","DC"],wide:["antes de cristo","después de cristo"]},ut={narrow:["1","2","3","4"],abbreviated:["T1","T2","T3","T4"],wide:["1º trimestre","2º trimestre","3º trimestre","4º trimestre"]},mt={narrow:["e","f","m","a","m","j","j","a","s","o","n","d"],abbreviated:["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"],wide:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"]},ht={narrow:["d","l","m","m","j","v","s"],short:["do","lu","ma","mi","ju","vi","sá"],abbreviated:["dom","lun","mar","mié","jue","vie","sáb"],wide:["domingo","lunes","martes","miércoles","jueves","viernes","sábado"]},ft={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"}},gt={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"}},bt=(e,r)=>Number(e)+"º",xt={ordinalNumber:bt,era:b({values:ct,defaultWidth:"wide"}),quarter:b({values:ut,defaultWidth:"wide",argumentCallback:e=>Number(e)-1}),month:b({values:mt,defaultWidth:"wide"}),day:b({values:ht,defaultWidth:"wide"}),dayPeriod:b({values:ft,defaultWidth:"wide",formattingValues:gt,defaultFormattingWidth:"wide"})},pt=/^(\d+)(º)?/i,vt=/\d+/i,yt={narrow:/^(ac|dc|a|d)/i,abbreviated:/^(a\.?\s?c\.?|a\.?\s?e\.?\s?c\.?|d\.?\s?c\.?|e\.?\s?c\.?)/i,wide:/^(antes de cristo|antes de la era com[uú]n|despu[eé]s de cristo|era com[uú]n)/i},wt={any:[/^ac/i,/^dc/i],wide:[/^(antes de cristo|antes de la era com[uú]n)/i,/^(despu[eé]s de cristo|era com[uú]n)/i]},Nt={narrow:/^[1234]/i,abbreviated:/^T[1234]/i,wide:/^[1234](º)? trimestre/i},kt={any:[/1/i,/2/i,/3/i,/4/i]},Mt={narrow:/^[efmajsond]/i,abbreviated:/^(ene|feb|mar|abr|may|jun|jul|ago|sep|oct|nov|dic)/i,wide:/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre)/i},jt={narrow:[/^e/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^en/i,/^feb/i,/^mar/i,/^abr/i,/^may/i,/^jun/i,/^jul/i,/^ago/i,/^sep/i,/^oct/i,/^nov/i,/^dic/i]},At={narrow:/^[dlmjvs]/i,short:/^(do|lu|ma|mi|ju|vi|s[áa])/i,abbreviated:/^(dom|lun|mar|mi[ée]|jue|vie|s[áa]b)/i,wide:/^(domingo|lunes|martes|mi[ée]rcoles|jueves|viernes|s[áa]bado)/i},Pt={narrow:[/^d/i,/^l/i,/^m/i,/^m/i,/^j/i,/^v/i,/^s/i],any:[/^do/i,/^lu/i,/^ma/i,/^mi/i,/^ju/i,/^vi/i,/^sa/i]},Dt={narrow:/^(a|p|mn|md|(de la|a las) (mañana|tarde|noche))/i,any:/^([ap]\.?\s?m\.?|medianoche|mediodia|(de la|a las) (mañana|tarde|noche))/i},_t={any:{am:/^a/i,pm:/^p/i,midnight:/^mn/i,noon:/^md/i,morning:/mañana/i,afternoon:/tarde/i,evening:/tarde/i,night:/noche/i}},It={ordinalNumber:Z({matchPattern:pt,parsePattern:vt,valueCallback:function(e){return parseInt(e,10)}}),era:x({matchPatterns:yt,defaultMatchWidth:"wide",parsePatterns:wt,defaultParseWidth:"any"}),quarter:x({matchPatterns:Nt,defaultMatchWidth:"wide",parsePatterns:kt,defaultParseWidth:"any",valueCallback:e=>e+1}),month:x({matchPatterns:Mt,defaultMatchWidth:"wide",parsePatterns:jt,defaultParseWidth:"any"}),day:x({matchPatterns:At,defaultMatchWidth:"wide",parsePatterns:Pt,defaultParseWidth:"any"}),dayPeriod:x({matchPatterns:Dt,defaultMatchWidth:"any",parsePatterns:_t,defaultParseWidth:"any"})},St={code:"es",formatDistance:at,formatLong:it,formatRelative:lt,localize:xt,match:It,options:{weekStartsOn:1,firstWeekContainsDate:1}},Tt=({item:e})=>{var d;const r=U(),t=et(e.timestamp,{addSuffix:!0,locale:St}),s=e.rawStatus==="Pendiente";let a={icon:"notifications",bgIcon:"bg-slate-50 text-slate-600 dark:bg-slate-800 dark:text-slate-400",actionText:"Ver",path:"#",highlightRing:"group-hover:ring-slate-100 dark:group-hover:ring-slate-800"};e.type==="finalization"?a={icon:"school",bgIcon:"bg-emerald-50 text-emerald-600 dark:bg-emerald-500/10 dark:text-emerald-400",actionText:"Revisar",path:"/admin/solicitudes?tab=egreso",highlightRing:"group-hover:ring-emerald-100 dark:group-hover:ring-emerald-900/30"}:e.type==="request"?a={icon:"person_add",bgIcon:"bg-blue-50 text-blue-600 dark:bg-blue-500/10 dark:text-blue-400",actionText:"Gestionar",path:"/admin/solicitudes?tab=ingreso",highlightRing:"group-hover:ring-blue-100 dark:group-hover:ring-blue-900/30"}:e.type==="launch"&&(a={icon:"rocket_launch",bgIcon:"bg-indigo-50 text-indigo-600 dark:bg-indigo-500/10 dark:text-indigo-400",actionText:"Ver Inscriptos",path:`/admin/lanzador?tab=seleccionador&launchId=${e.id.replace("lanz-","")}`,highlightRing:"group-hover:ring-indigo-100 dark:group-hover:ring-indigo-900/30"});const f=o=>{o.stopPropagation(),a.path!=="#"&&r(a.path)};return n.jsxs("div",{onClick:f,className:"group relative flex items-start gap-4 p-4 rounded-xl transition-all duration-300 cursor-pointer hover:bg-slate-50 dark:hover:bg-slate-800/50 border border-transparent hover:border-slate-100 dark:hover:border-slate-700/50",children:[n.jsx("div",{className:`flex-shrink-0 w-10 h-10 rounded-full flex items-center justify-center ${a.bgIcon} shadow-sm ring-4 ring-transparent ${a.highlightRing} transition-all duration-300`,children:n.jsx("span",{className:"material-icons !text-lg",children:a.icon})}),n.jsxs("div",{className:"flex-1 min-w-0 pt-0.5",children:[n.jsxs("div",{className:"flex justify-between items-start",children:[n.jsx("h4",{className:"text-sm font-bold text-slate-800 dark:text-slate-200 truncate pr-2",children:e.user}),n.jsx("span",{className:"text-[10px] font-medium text-slate-400 whitespace-nowrap",children:t})]}),n.jsxs("div",{className:"text-xs text-slate-500 dark:text-slate-400 mt-0.5 flex flex-wrap items-center gap-2",children:[n.jsx("span",{className:"truncate max-w-[200px]",children:e.type==="finalization"?"Solicita Acreditación":e.type==="launch"?"Convocatoria Abierta":"Solicita Ingreso"}),e.isNew&&s&&e.type!=="launch"&&n.jsx("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-[9px] font-bold uppercase bg-blue-100 text-blue-700 dark:bg-blue-900/40 dark:text-blue-300 tracking-wide",children:"Nuevo"}),e.type==="launch"&&((d=e.metadata)==null?void 0:d.count)!==void 0&&n.jsxs("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded text-[10px] font-bold bg-indigo-100 text-indigo-700 dark:bg-indigo-900/40 dark:text-indigo-300 animate-pulse",children:[n.jsx("span",{className:"material-icons !text-[10px]",children:"group"}),e.metadata.count," inscriptos"]})]}),e.institution&&n.jsxs("div",{className:"mt-2 inline-flex items-center gap-1.5 text-xs font-medium text-slate-600 dark:text-slate-300 bg-white dark:bg-slate-700/50 px-2 py-1 rounded-md border border-slate-200 dark:border-slate-700 shadow-sm max-w-full",children:[n.jsx("span",{className:"material-icons !text-[12px] text-slate-400",children:"business"}),n.jsx("span",{className:"truncate",children:e.institution})]})]}),n.jsx("div",{className:"absolute right-4 bottom-4 opacity-0 group-hover:opacity-100 transition-all duration-200 transform translate-x-2 group-hover:translate-x-0",children:n.jsxs("div",{className:"flex items-center gap-1 text-xs font-bold text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/30 px-2 py-1 rounded-lg",children:[a.actionText," ",n.jsx("span",{className:"material-icons !text-xs",children:"arrow_forward"})]})})]})},Ct=({isTestingMode:e})=>{const{data:r,isLoading:t}=le(e),s=ee.useMemo(()=>r?r.slice(0,5):[],[r]);return t?n.jsxs("div",{className:"bg-white dark:bg-[#0F172A] rounded-2xl border border-slate-200/60 dark:border-slate-800 p-6 h-full min-h-[300px]",children:[n.jsx("div",{className:"h-6 w-32 bg-slate-200 dark:bg-slate-700 rounded animate-pulse mb-6"}),n.jsx("div",{className:"space-y-6",children:[1,2,3].map(a=>n.jsxs("div",{className:"flex gap-4",children:[n.jsx("div",{className:"w-10 h-10 rounded-full bg-slate-100 dark:bg-slate-800 animate-pulse"}),n.jsxs("div",{className:"flex-1 space-y-2",children:[n.jsx("div",{className:"h-4 w-3/4 bg-slate-100 dark:bg-slate-800 rounded animate-pulse"}),n.jsx("div",{className:"h-3 w-1/2 bg-slate-100 dark:bg-slate-800 rounded animate-pulse"})]})]},a))})]}):n.jsxs("div",{className:"glass-panel rounded-2xl border border-slate-200/60 dark:border-slate-800 shadow-sm overflow-hidden h-full flex flex-col",children:[n.jsx("div",{className:"px-6 py-5 border-b border-slate-100 dark:border-slate-800/50 flex justify-between items-center",children:n.jsxs("h3",{className:"font-bold text-lg text-slate-800 dark:text-white flex items-center gap-2",children:[n.jsx("span",{className:"material-icons text-indigo-500 !text-xl",children:"history"}),"Actividad Reciente"]})}),n.jsx("div",{className:"p-2 flex-grow",children:s.length>0?n.jsx("div",{className:"space-y-1",children:s.map(a=>n.jsx(Tt,{item:a},a.id))}):n.jsxs("div",{className:"flex flex-col items-center justify-center py-16 text-center opacity-60",children:[n.jsx("div",{className:"bg-slate-50 dark:bg-slate-800/50 p-4 rounded-full mb-3",children:n.jsx("span",{className:"material-icons text-slate-300 dark:text-slate-600 !text-3xl",children:"notifications_off"})}),n.jsx("p",{className:"text-sm font-medium text-slate-500 dark:text-slate-400",children:"No hay actividad reciente"})]})}),r&&r.length>5&&n.jsx("div",{className:"px-6 py-3 border-t border-slate-100 dark:border-slate-800/50 bg-slate-50/50 dark:bg-slate-900/30 text-center",children:n.jsxs("span",{className:"text-xs text-slate-400 font-medium",children:["Mostrando 5 de ",r.length," movimientos"]})})]})},A=({title:e,count:r,icon:t,color:s,onClick:a,label:f,subCount:d,subLabel:o})=>{const c={red:{hoverBorder:"group-hover:border-rose-300 dark:group-hover:border-rose-700",iconBg:"bg-rose-50 text-rose-600 dark:bg-rose-900/20 dark:text-rose-400",countText:"text-rose-700 dark:text-rose-400",hoverBg:"hover:bg-rose-50/50 dark:hover:bg-rose-900/10",gradient:"from-white to-rose-50/30 dark:from-slate-800 dark:to-rose-900/10",glow:"group-hover:shadow-rose-500/10"},amber:{hoverBorder:"group-hover:border-amber-300 dark:group-hover:border-amber-700",iconBg:"bg-amber-50 text-amber-600 dark:bg-amber-900/20 dark:text-amber-400",countText:"text-amber-700 dark:text-amber-400",hoverBg:"hover:bg-amber-50/50 dark:hover:bg-amber-900/10",gradient:"from-white to-amber-50/30 dark:from-slate-800 dark:to-amber-900/10",glow:"group-hover:shadow-amber-500/10"},emerald:{hoverBorder:"group-hover:border-emerald-300 dark:group-hover:border-emerald-700",iconBg:"bg-emerald-50 text-emerald-600 dark:bg-emerald-900/20 dark:text-emerald-400",countText:"text-emerald-700 dark:text-emerald-400",hoverBg:"hover:bg-emerald-50/50 dark:hover:bg-emerald-900/10",gradient:"from-white to-emerald-50/30 dark:from-slate-800 dark:to-emerald-900/10",glow:"group-hover:shadow-emerald-500/10"},blue:{hoverBorder:"group-hover:border-blue-300 dark:group-hover:border-blue-700",iconBg:"bg-blue-50 text-blue-600 dark:bg-blue-900/20 dark:text-blue-400",countText:"text-blue-700 dark:text-blue-400",hoverBg:"hover:bg-blue-50/50 dark:hover:bg-blue-900/10",gradient:"from-white to-blue-50/30 dark:from-slate-800 dark:to-blue-900/10",glow:"group-hover:shadow-blue-500/10"}}[s];return n.jsxs("button",{onClick:a,className:`flex flex-col p-6 rounded-[2rem] border border-slate-200 dark:border-slate-800 bg-gradient-to-br ${c.gradient} transition-all duration-300 hover:-translate-y-1 hover:shadow-xl ${c.glow} text-left group ${c.hoverBorder}`,children:[n.jsxs("div",{className:"flex justify-between items-start w-full mb-4",children:[n.jsx("div",{className:`p-3 rounded-xl shadow-sm transition-colors ${c.iconBg}`,children:n.jsx("span",{className:"material-icons !text-2xl",children:t})}),n.jsx("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity transform translate-x-2 group-hover:translate-x-0 text-slate-400 dark:text-slate-500",children:n.jsx("span",{className:"material-icons !text-xl",children:"arrow_forward"})})]}),n.jsxs("div",{className:"mt-auto w-full",children:[n.jsxs("div",{className:"flex justify-between items-end mb-1",children:[n.jsx("span",{className:`text-4xl font-black tracking-tight ${c.countText}`,children:r}),d!==void 0&&d>0&&n.jsxs("span",{className:"text-[10px] font-bold bg-white/50 dark:bg-black/20 backdrop-blur-sm text-slate-600 dark:text-slate-300 px-2 py-1 rounded-full mb-1 border border-slate-200/50 dark:border-slate-700/50",children:[d," ",o]})]}),n.jsx("h4",{className:"font-bold text-slate-800 dark:text-slate-200 text-base",children:e}),n.jsx("p",{className:"text-xs font-medium text-slate-500 dark:text-slate-400 mt-1",children:f})]})]})},Ot=({isTestingMode:e=!1})=>{const r=U(),[t,s]=te.useState(null),{data:a,isLoading:f,error:d}=de(e);if(f)return n.jsx(ae,{});if(d)return n.jsx(ne,{icon:"error",title:"Error",message:d==null?void 0:d.message});const o=new Date,u=((a==null?void 0:a.endingLaunches)||[]).filter(h=>h.daysLeft<0),g=new Set(u.map(h=>(h[T]||"").split(" - ")[0].trim())).size;let i=0;((a==null?void 0:a.pendingRequests)||[]).forEach(h=>{if(!h.updated)return;const y=new Date(h.updated);oe(o,y)>5&&i++});const l=((a==null?void 0:a.pendingFinalizations)||[]).length,m=((a==null?void 0:a.endingLaunches)||[]).filter(h=>h.daysLeft>=0&&h.daysLeft<=30).length;return n.jsxs("div",{className:"space-y-12 animate-fade-in-up pb-10",children:[t&&n.jsx(re,{message:t.message,type:t.type,onClose:()=>s(null)}),(a==null?void 0:a.closingAlerts)&&a.closingAlerts.length>0&&n.jsx("div",{className:"mx-4 md:mx-0 p-4 bg-orange-50 dark:bg-orange-900/10 border-l-4 border-orange-500 rounded-r-xl shadow-sm animate-fade-in-up",children:n.jsxs("div",{className:"flex items-start gap-3",children:[n.jsx("div",{className:"p-2 bg-orange-100 dark:bg-orange-900/30 rounded-lg text-orange-600 dark:text-orange-400",children:n.jsx("span",{className:"material-icons",children:"warning_amber"})}),n.jsxs("div",{className:"flex-1 w-full",children:[n.jsx("h4",{className:"font-black text-orange-800 dark:text-orange-200 text-sm uppercase tracking-wide mb-1",children:"Acción Requerida: Cierre de Inscripciones"}),n.jsx("p",{className:"text-xs text-orange-700/80 dark:text-orange-300/70 mb-3",children:"Las siguientes convocatorias inician pronto y deben cerrarse para seleccionar estudiantes."}),n.jsx("div",{className:"space-y-2",children:a.closingAlerts.map(h=>n.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center bg-white dark:bg-slate-800 p-3 rounded-lg border border-orange-100 dark:border-orange-900/30 shadow-sm gap-3",children:[n.jsxs("div",{children:[n.jsx("p",{className:"font-bold text-slate-700 dark:text-slate-200 text-sm",children:h.name}),n.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[n.jsx("span",{className:`text-[10px] font-bold px-1.5 py-0.5 rounded ${h.daysRemaining<=0?"bg-rose-100 text-rose-700":"bg-amber-100 text-amber-700"}`,children:h.isClosingToday?"CIERRA HOY":h.daysRemaining<0?"INSCRIPCIÓN FINALIZADA":`${h.daysRemaining} días restantes`}),n.jsxs("span",{className:"text-[10px] text-slate-400",children:["Cierre: ",se(h.closingDate)]})]})]}),n.jsx("button",{onClick:()=>r("/admin/seleccionador"),className:"w-full sm:w-auto text-xs font-bold text-white bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded-lg transition-colors shadow-blue-500/20 shadow-lg",children:"IR A SELECCIONAR"})]},h.id))})]})]})}),n.jsxs("section",{className:"space-y-6",children:[n.jsxs("div",{className:"flex items-center gap-3 px-4",children:[n.jsx("div",{className:"h-6 w-1 bg-blue-600 rounded-full"}),n.jsx("h3",{className:"text-lg font-black text-slate-800 dark:text-white uppercase tracking-wider",children:"Estado Operativo"})]}),n.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:[n.jsx(A,{title:"Instituciones Vencidas",count:g,label:"Gestión requerida",icon:"event_busy",color:"red",onClick:()=>r("/admin/gestion?filter=vencidas")}),n.jsx(A,{title:"Demoradas",count:i,label:"Sin cambio +5 días",icon:"hourglass_empty",color:"amber",onClick:()=>r("/admin/solicitudes?tab=ingreso")}),n.jsx(A,{title:"Acreditaciones",count:l,label:"Pendientes de carga",icon:"verified",color:"emerald",onClick:()=>r("/admin/solicitudes?tab=egreso")}),n.jsx(A,{title:"Próximas a Vencer",count:m,label:"Vencen este mes",icon:"update",color:"blue",onClick:()=>r("/admin/gestion?filter=proximas")})]})]}),n.jsx("section",{className:"pt-4",children:n.jsx(Ct,{isTestingMode:e})})]})};export{Ot as default};
