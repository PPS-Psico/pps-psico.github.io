const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./exceljs.min-B8t_jxSM.js","./index-ZXlslG1z.js","./index-BZxwZwPS.css","./_commonjs-dynamic-modules-TDtrdbi3.js","./FileSaver.min-iB6v0HDW.js"])))=>i.map(i=>d[i]);
import{R as aa,j as e,T as Fe,r as x,g as Ta,O as De,n as W,a1 as U,h as ie,i as xe,a6 as Q,a7 as $e,a8 as Ba,J as L,a9 as Je,aa as We,ab as da,ac as ua,F as X,ad as Pe,ae as ma,af as sa,ag as ta,ah as xa,ai as pa,aj as ba,ak as Ge,al as ra,am as oa,an as Me,ao as la,ap as be,aq as ha,M as Z,C as ia,a5 as qe,ar as H,as as Ee,N as Ke,Z as ca,at as Va,$ as Ga,au as qa,_ as ga,av as Ka,aw as Ya,Q as le,ax as Ye,ay as Qa,az as Ve,aA as Za,a3 as Te,aB as te,aC as Xe,aD as ea,aE as Ja,aF as Wa,aG as Xa,aH as es,aI as as,aJ as ss,aK as ts,aL as rs,aM as os,aN as Da,aO as Ra,D as Fa,I as Pa,G as Ma,aP as na,aQ as ls,aR as fa,aS as me,aT as Oe,aU as is,aV as ns,aW as cs,aX as ds,aY as us,aZ as ms,a_ as xs,a$ as ps,b0 as Be,b1 as bs,e as hs}from"./index-ZXlslG1z.js";import{S as Ua}from"./SubTabs-B9w5BDf5.js";import{A as za}from"./types-Cg8ilULs.js";import{R as gs,s as fs}from"./dbSchema-B3bE2DnB.js";import{C as Ns}from"./CollapsibleSection-DXbQB952.js";import{S as Ha}from"./Select-DhRNnplj.js";import{C as vs}from"./ConvocatoriaCardPremium-Cd-vXGWP.js";import{s as js}from"./emailService-DD1-Dxe1.js";import{C as Es}from"./ConfirmModal-DfSwa4qW.js";import"./UnifiedTabs-xSvmzb6C.js";import"./proxy-BFxRqQFC.js";const pe=aa.forwardRef(({id:a,checked:g,onChange:f,disabled:m=!1,label:d,sublabel:t,className:I="",wrapperClassName:N="",labelClassName:c="",error:v,...T},P)=>e.jsxs("label",{htmlFor:a,className:`
            group flex items-start gap-3 p-2 rounded-lg transition-colors 
            ${m?"cursor-not-allowed opacity-60":"cursor-pointer hover:bg-slate-50 dark:hover:bg-slate-900/40"}
            ${v?"bg-red-50 dark:bg-red-900/10":""}
            ${N}
        `,children:[e.jsxs("div",{className:"relative flex items-center h-6",children:[e.jsx("input",{id:a,type:"checkbox",checked:g,onChange:f,disabled:m,ref:P,className:"peer sr-only",...T}),e.jsx("div",{className:`
            h-5 w-5 rounded border-2 transition-all duration-200 ease-out flex items-center justify-center
            peer-focus-visible:ring-4 peer-focus-visible:ring-blue-100 dark:peer-focus-visible:ring-blue-900/30
            
            ${g?"bg-blue-600 border-blue-600 dark:bg-blue-500 dark:border-blue-500":v?"bg-white dark:bg-slate-950 border-red-300 dark:border-red-500/50 group-hover:border-red-400":"bg-white dark:bg-slate-950 border-slate-300 dark:border-slate-700 group-hover:border-blue-400 dark:group-hover:border-blue-500"}
            
            ${I}
        `,children:e.jsx("svg",{className:`w-3.5 h-3.5 text-white transition-transform duration-200 ${g?"scale-100":"scale-0"}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"3",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 12.75l6 6 9-13.5"})})})]}),(d||t)&&e.jsxs("div",{className:"flex flex-col select-none",children:[d&&e.jsx("span",{className:`text-sm font-medium transition-colors ${v?"text-red-600 dark:text-red-400":"text-slate-700 dark:text-slate-200 group-hover:text-amber-900 dark:group-hover:text-blue-100"} ${c}`,children:d}),t&&e.jsx("span",{className:"text-xs text-slate-500 dark:text-slate-400",children:t})]})]}));pe.displayName="Checkbox";const $a={sendPush:async a=>{try{console.log("[NotificationService] Triggering push:",a);const{data:g,error:f}=await Fe.functions.invoke("send-push",{body:a});return f?(console.error("[NotificationService] Edge Function Error:",f),{success:!1,error:f.message}):{success:!0}}catch(g){return console.error("[NotificationService] Unexpected Error:",g),{success:!1,error:g.message}}},notifyNewLaunch:async a=>$a.sendPush({title:"ðŸš€ Â¡Nueva Convocatoria Abierta!",message:`Ya podÃ©s inscribirte en: ${a}`,url:"/student"})};var Na;(function(a){a.STRING="string",a.NUMBER="number",a.INTEGER="integer",a.BOOLEAN="boolean",a.ARRAY="array",a.OBJECT="object"})(Na||(Na={}));/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var va;(function(a){a.LANGUAGE_UNSPECIFIED="language_unspecified",a.PYTHON="python"})(va||(va={}));var ja;(function(a){a.OUTCOME_UNSPECIFIED="outcome_unspecified",a.OUTCOME_OK="outcome_ok",a.OUTCOME_FAILED="outcome_failed",a.OUTCOME_DEADLINE_EXCEEDED="outcome_deadline_exceeded"})(ja||(ja={}));var Ea;(function(a){a.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",a.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",a.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",a.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",a.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",a.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(Ea||(Ea={}));var Ia;(function(a){a.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",a.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",a.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",a.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",a.BLOCK_NONE="BLOCK_NONE"})(Ia||(Ia={}));var Ca;(function(a){a.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",a.NEGLIGIBLE="NEGLIGIBLE",a.LOW="LOW",a.MEDIUM="MEDIUM",a.HIGH="HIGH"})(Ca||(Ca={}));var Aa;(function(a){a.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",a.SAFETY="SAFETY",a.OTHER="OTHER"})(Aa||(Aa={}));var Re;(function(a){a.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",a.STOP="STOP",a.MAX_TOKENS="MAX_TOKENS",a.SAFETY="SAFETY",a.RECITATION="RECITATION",a.LANGUAGE="LANGUAGE",a.BLOCKLIST="BLOCKLIST",a.PROHIBITED_CONTENT="PROHIBITED_CONTENT",a.SPII="SPII",a.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",a.OTHER="OTHER"})(Re||(Re={}));var Sa;(function(a){a.TASK_TYPE_UNSPECIFIED="TASK_TYPE_UNSPECIFIED",a.RETRIEVAL_QUERY="RETRIEVAL_QUERY",a.RETRIEVAL_DOCUMENT="RETRIEVAL_DOCUMENT",a.SEMANTIC_SIMILARITY="SEMANTIC_SIMILARITY",a.CLASSIFICATION="CLASSIFICATION",a.CLUSTERING="CLUSTERING"})(Sa||(Sa={}));var ka;(function(a){a.MODE_UNSPECIFIED="MODE_UNSPECIFIED",a.AUTO="AUTO",a.ANY="ANY",a.NONE="NONE"})(ka||(ka={}));var _a;(function(a){a.MODE_UNSPECIFIED="MODE_UNSPECIFIED",a.MODE_DYNAMIC="MODE_DYNAMIC"})(_a||(_a={}));var ya;(function(a){a.GENERATE_CONTENT="generateContent",a.STREAM_GENERATE_CONTENT="streamGenerateContent",a.COUNT_TOKENS="countTokens",a.EMBED_CONTENT="embedContent",a.BATCH_EMBED_CONTENTS="batchEmbedContents"})(ya||(ya={}));Re.RECITATION,Re.SAFETY,Re.LANGUAGE;const wa=[{id:"recInstMock1",[Q]:"Hospital de Juguete"},{id:"recInstMock2",[Q]:"Escuela de Pruebas"},{id:"recInstMock3",[Q]:"Empresa Ficticia S.A."}],Is={id:"recLanzMock1",[be]:"Clinica",[la]:120,[Me]:5,[Pe]:"Lunes 9 a 13hs; MiÃ©rcoles 14 a 18hs",[oa]:!0,[ra]:!1,[Ge]:"Calle Falsa 123",[Ya]:"<div>Test</div>",descripcion:"Mock description",actividades:["Act 1"],requisitoObligatorio:""},Oa={nombrePPS:"",fechaInicio:"",fechaFin:"",fechaInicioInscripcion:"",fechaFinInscripcion:"",orientacion:"",horasAcreditadas:0,cuposDisponibles:1,estadoConvocatoria:"Abierta",reqCertificadoTrabajo:!0,reqCv:!1,direccion:"",descripcion:"",requisitoObligatorio:"",programarLanzamiento:!1,fechaPublicacion:"",mensajeWhatsApp:"",actividadesLabel:"Actividades",horariosFijos:!1},se=({label:a,icon:g,children:f,className:m=""})=>e.jsxs("div",{className:`group ${m}`,children:[e.jsxs("label",{className:"block text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider mb-2 ml-1 flex items-center gap-2",children:[e.jsx("span",{className:"material-icons text-slate-300 dark:text-slate-600 group-focus-within:text-blue-500 transition-colors !text-sm",children:g}),a]}),f]}),Cs=({isOpen:a,onClose:g,onConfirm:f,isLoading:m})=>{const[d,t]=x.useState({nombre:"",direccion:"",telefono:"",tutor:"",orientacionSugerida:"",logoFile:null,invertLogo:!1});if(!a)return null;const I=c=>{c.preventDefault(),f(d)},N=c=>{c.target.files&&c.target.files[0]&&t({...d,logoFile:c.target.files[0]})};return e.jsx("div",{className:"fixed inset-0 z-[1300] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4 animate-fade-in",onClick:g,children:e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl shadow-2xl w-full max-w-lg overflow-hidden border border-slate-200 dark:border-slate-700",onClick:c=>c.stopPropagation(),children:[e.jsxs("div",{className:"p-6 border-b border-slate-200 dark:border-slate-700 bg-slate-50/50 dark:bg-slate-900/50",children:[e.jsxs("h3",{className:"text-xl font-bold text-slate-800 dark:text-white flex items-center gap-2",children:[e.jsx("span",{className:"material-icons text-blue-600",children:"add_business"}),"Registrar Nueva InstituciÃ³n"]}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 mt-1",children:'Esta instituciÃ³n se guardarÃ¡ como "Convenio Nuevo".'})]}),e.jsxs("form",{onSubmit:I,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider mb-1.5 ml-1",children:"Nombre InstituciÃ³n *"}),e.jsx(H,{value:d.nombre,onChange:c=>t({...d,nombre:c.target.value}),placeholder:"Ej: FundaciÃ³n Crecer",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider mb-1.5 ml-1",children:"DirecciÃ³n"}),e.jsx(H,{value:d.direccion,onChange:c=>t({...d,direccion:c.target.value}),placeholder:"Calle y Altura"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider mb-1.5 ml-1",children:"TelÃ©fono"}),e.jsx(H,{value:d.telefono,onChange:c=>t({...d,telefono:c.target.value}),placeholder:"Cod. Ãrea + Nro"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider mb-1.5 ml-1",children:"Tutor (Lic. en PsicologÃ­a)"}),e.jsx(H,{value:d.tutor,onChange:c=>t({...d,tutor:c.target.value}),placeholder:"Nombre y Apellido"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider mb-2 ml-1",children:"OrientaciÃ³n Sugerida"}),e.jsxs(Ha,{value:d.orientacionSugerida,onChange:c=>t({...d,orientacionSugerida:c.target.value}),children:[e.jsx("option",{value:"",children:"Seleccionar para pre-llenar..."}),za.map(c=>e.jsx("option",{value:c,children:c},c))]})]}),e.jsxs("div",{className:"pt-2 border-t border-slate-100 dark:border-slate-700 mt-2",children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider mb-2 ml-1",children:"Logo Institucional (Opcional)"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("label",{className:"cursor-pointer bg-slate-100 dark:bg-slate-700 hover:bg-slate-200 dark:hover:bg-slate-600 transition-colors px-4 py-2 rounded-lg text-sm text-slate-600 dark:text-slate-300 flex items-center gap-2",children:[e.jsx("span",{className:"material-icons !text-lg",children:"upload_file"}),d.logoFile?"Cambiar Logo":"Subir Logo",e.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:N})]}),d.logoFile&&e.jsx("span",{className:"text-sm text-emerald-600 dark:text-emerald-400 font-medium truncate max-w-[150px]",children:d.logoFile.name})]}),e.jsx("div",{className:"mt-3",children:e.jsx(pe,{label:"Invertir colores en Modo Oscuro (para logos muy oscuros)",checked:d.invertLogo,onChange:c=>t({...d,invertLogo:c.target.checked})})})]}),e.jsxs("div",{className:"pt-4 flex justify-end gap-3",children:[e.jsx(Ee,{variant:"secondary",onClick:g,type:"button",children:"Cancelar"}),e.jsx(Ee,{variant:"primary",type:"submit",isLoading:m,disabled:!d.nombre,children:"Guardar InstituciÃ³n"})]})]})]})})},As={label:"Lanzamientos",schema:fs.lanzamientos,fieldConfig:[{key:X,label:"Nombre PPS",type:"text"},{key:ie,label:"Fecha Inicio",type:"date"},{key:ca,label:"Fecha FinalizaciÃ³n",type:"date"},{key:be,label:"OrientaciÃ³n",type:"select",options:["Clinica","Educacional","Laboral","Comunitaria"]},{key:U,label:"Estado",type:"select",options:["Abierta","Cerrado","Oculto"]},{key:ta,label:"Etiqueta Lista",type:"text"}]},La=({isTestingMode:a=!1,forcedTab:g})=>{const[f,m]=x.useState("new"),d=g||f,[t,I]=x.useState(Oa),[N,c]=x.useState([""]),[v,T]=x.useState([]),[P,z]=x.useState(""),[D,$]=x.useState(!1),[B,j]=x.useState(null),[q,ee]=x.useState(""),[y,K]=x.useState(null),[M,re]=x.useState(!1),[he,Ae]=x.useState(!1),J=Ta(),h=async s=>{try{await navigator.clipboard.writeText(s),Ae(!0),setTimeout(()=>Ae(!1),2e3)}catch(r){console.error("Failed to copy text: ",r),j({message:"Error al copiar al portapapeles",type:"error"})}},o=async()=>{if(P.trim()){j({message:"âš ï¸ API Key de Gemini no detectada. Verifica tu archivo .env",type:"error"});return}},l=()=>{const s=t.fechaInicioInscripcion&&t.fechaFinInscripcion?`Desde *${Z(t.fechaInicioInscripcion)}* hasta el *${Z(t.fechaFinInscripcion)}*`:"*A confirmar*";let r="A confirmar";if(t.fechaInicio&&t.fechaFin){const S=new Date(t.fechaInicio),E=new Date(t.fechaFin);if(!isNaN(S.getTime())&&!isNaN(E.getTime())){const _=Math.ceil(Math.abs(E.getTime()-S.getTime())/864e5);if(_>=30){const Y=Math.round(_/30);r=`${Y} ${Y===1?"mes":"meses"} (aprox.)`}else if(_>=7){const Y=Math.round(_/7);r=`${Y} ${Y===1?"semana":"semanas"}`}else r=`${_} ${_===1?"dÃ­a":"dÃ­as"}`}}const i=`ðŸ“¢ *Â¡Nueva Convocatoria PPS: ${t.nombrePPS||"PrÃ¡ctica Profesional"}!* ðŸ“¢

âœ¨ *InstituciÃ³n:* ${t.nombrePPS||"A confirmar"}.
ðŸ“ *Lugar:* ${t.direccion||"A confirmar"}.

ðŸŽ¯ *Objetivo:* ${t.descripcion||"Describir el objetivo de la prÃ¡ctica."}

*Detalles de la PrÃ¡ctica:*
â±ï¸ *Acredita:* ${t.horasAcreditadas||0} hs totales (${t.orientacion||"OrientaciÃ³n"}).
â³ *DuraciÃ³n:* ${r}.
ðŸ‘¥ *Cupo:* ${t.cuposDisponibles||0} estudiantes.
ðŸ“ *Modalidad:* ${t.direccion==="Modalidad Virtual"?"Virtual":"Presencial"}.

*Horarios y DedicaciÃ³n:*
ðŸ—“ï¸ *Cursada:* ${N.filter(Boolean).join("; ")||"A confirmar"}.

*Fechas Clave:*
â€¼ï¸ *INSCRIPCIÃ“N:* ${s}. â€¼ï¸
ðŸš€ *Inicio de PrÃ¡cticas:* ${t.fechaInicio?Z(t.fechaInicio):"A confirmar"}.

*Requisito Obligatorio:*
ðŸ“„ ${t.reqCv?"Subir CV actualizado al momento de inscribirse.":t.requisitoObligatorio||"Sin requisitos adicionales."}

ðŸ”— *InscripciÃ³n en Mi Panel.*`;I(S=>({...S,mensajeWhatsApp:i})),F(!0)},[n,p]=x.useState(!1),[C,k]=x.useState(null),[w,F]=x.useState(!1),{data:V=[]}=De({queryKey:["allInstitutionsForLauncher",a],queryFn:()=>a?Promise.resolve(wa):L.instituciones.getAll({fields:[Q,Ka,$e,ua,da,We,Je]})}),{data:u}=De({queryKey:["lastLanzamiento",y==null?void 0:y.id,a],queryFn:async()=>{if(!y)return null;if(a)return wa.some(r=>r.id===y.id)?Is:null;let s=await L.lanzamientos.get({filters:{institucion_id:y.id},sort:[{field:"fecha_inicio",direction:"desc"}],maxRecords:1});return s.length===0&&(s=await L.lanzamientos.get({filters:{[X]:`%${y[Q]}%`},sort:[{field:"fecha_inicio",direction:"desc"}],maxRecords:1})),s[0]||null},enabled:!!y}),{data:A=[]}=De({queryKey:["launchHistory",a],queryFn:async()=>a?[]:L.lanzamientos.getAll({sort:[{field:ie,direction:"desc"}]}),enabled:!0}),{visibleHistory:R,hiddenHistory:b,scheduledHistory:ge}=x.useMemo(()=>{const s=[...A].sort((E,_)=>{const Y=W(E[U]),ae=W(_[U]),ye=Y==="abierta"||Y==="abierto",we=ae==="abierta"||ae==="abierto";if(ye&&!we)return-1;if(!ye&&we)return 1;const He=new Date(E[ie]||0).getTime();return new Date(_[ie]||0).getTime()-He}),r=[],i=[],S=[];return s.forEach(E=>{const _=W(E[U]);_==="programada"||_==="programado"?S.push(E):_==="oculto"?i.push(E):r.push(E)}),{visibleHistory:r,hiddenHistory:i,scheduledHistory:S}},[A]),ne=xe({mutationFn:async s=>{if(a)return{id:"new-mock",...s,[Q]:s.nombre};let r="";if(s.logoFile)try{r=await Ba(s.logoFile,s.nombre)}catch(i){throw console.error("Failed to upload logo:",i),i}return L.instituciones.create({[Q]:s.nombre,[$e]:s.direccion,[ua]:s.telefono,[da]:s.tutor,[We]:r||void 0,[Je]:s.invertLogo})},onSuccess:(s,r)=>{j({message:"InstituciÃ³n registrada con Ã©xito.",type:"success"}),K(s),ee(s[Q]),I(i=>({...i,nombrePPS:s[Q],orientacion:r.orientacionSugerida,direccion:s[$e]})),p(!1),a||J.invalidateQueries({queryKey:["allInstitutionsForLauncher"]})},onError:s=>j({message:`Error: ${s.message}`,type:"error"})}),G=xe({mutationFn:async s=>a?(console.log("TEST MODE: Simulating launch creation with data:",s),new Promise(r=>setTimeout(()=>r(null),1e3))):L.lanzamientos.create(s),onSuccess:(s,r)=>{j({message:"Convocatoria procesada con Ã©xito.",type:"success"}),r[U]==="Abierta"&&$a.notifyNewLaunch(r[X]).catch(i=>{console.error("[Lanzador] Error triggering push notification:",i)}),I(Oa),c([""]),T([]),ee(""),K(null),m("history"),F(!1),a||(J.invalidateQueries({queryKey:["allLanzamientos"]}),J.invalidateQueries({queryKey:["launchHistory"]}),J.invalidateQueries({queryKey:["conveniosData"]}))},onError:s=>{var i;const r=((i=s==null?void 0:s.error)==null?void 0:i.message)||(s==null?void 0:s.message)||JSON.stringify(s);j({message:`Error al lanzar: ${r}`,type:"error"})}}),ce=xe({mutationFn:({id:s,updates:r})=>L.lanzamientos.update(s,r),onSuccess:(s,r)=>{const i=r.updates[U];j({message:`Estado actualizado a "${i}".`,type:"success"}),J.invalidateQueries({queryKey:["launchHistory"]})},onError:s=>{j({message:`Error al actualizar estado: ${s.message}`,type:"error"})}}),oe=xe({mutationFn:async s=>{if(a)return null;console.log("[DELETE] Cleaning up dependencies for launch:",s);const{error:r}=await Fe.from("convocatorias").delete().eq("lanzamiento_id",s);r&&console.warn("Error deleting convocatorias:",r);const{error:i}=await Fe.from("practicas").delete().eq("lanzamiento_id",s);return i&&console.warn("Error deleting practicas:",i),console.log("[DELETE] Removing launch record..."),L.lanzamientos.delete(s)},onSuccess:()=>{j({message:"Lanzamiento y datos vinculados eliminados.",type:"success"}),J.invalidateQueries({queryKey:["launchHistory"]}),J.invalidateQueries({queryKey:["allConvocatorias"]}),J.invalidateQueries({queryKey:["allPracticas"]})},onError:s=>{console.error("Delete failed:",s);const r=(s==null?void 0:s.message)||"Error desconocido";j({message:`Error al eliminar: ${r}`,type:"error"})}}),de=xe({mutationFn:({id:s,fields:r})=>L.lanzamientos.update(s,r),onSuccess:()=>{j({message:"Lanzamiento actualizado.",type:"success"}),k(null),J.invalidateQueries({queryKey:["launchHistory"]})},onError:s=>{j({message:`Error al guardar cambios: ${s.message}`,type:"error"})}}),Ie=x.useMemo(()=>{if(!q)return[];const s=W(q);return V.filter(r=>W(r[Q]).includes(s)).slice(0,7)},[q,V]),Se=s=>{K(s),ee(s[Q]||""),I(r=>({...r,nombrePPS:s[Q]||"",direccion:s[$e]||r.direccion})),re(!1)},O=s=>{const{name:r,value:i,type:S}=s.target,E=s.target.checked;let _=S==="checkbox"?E:i;S==="date"&&typeof _=="string"&&_.includes("T")&&(_=_.split("T")[0]),I(Y=>({...Y,[r]:_}))},ue=(s,r)=>{const i=[...N];i[s]=r,c(i)},Ue=()=>c([...N,""]),Qe=s=>{const r=N.filter((i,S)=>S!==s);c(r.length?r:[""])},ke=(s,r)=>{const i=[...v];i[s]=r,T(i)},_e=()=>T([...v,""]),ze=s=>{const r=v.filter((i,S)=>S!==s);T(r)},fe=x.useCallback(()=>{if(!u)return;const s=u[Pe];let r=[""];s&&(r=s.split(";").map(E=>E.trim()).filter(Boolean),r.length===0&&(r=[""]));const i=u[ma];let S=[];if(Array.isArray(i))S=i.map(String);else if(typeof i=="string")try{const E=JSON.parse(i);Array.isArray(E)?S=E:S=[i]}catch{S=[i]}I(E=>({...E,orientacion:u[be]||"",horasAcreditadas:u[la]||0,cuposDisponibles:u[Me]||1,reqCertificadoTrabajo:u[oa]!==!1,reqCv:!!u[ra],direccion:u[Ge]||E.direccion,descripcion:u[ba]||"",requisitoObligatorio:u[pa]||"",fechaInicioInscripcion:"",fechaFinInscripcion:"",mensajeWhatsApp:u[xa]||"",actividadesLabel:u[ta]||"Actividades",horariosFijos:!!u[sa]})),c(r.length?r:[""]),T(S.length?S:[""]),j({message:"Datos anteriores cargados.",type:"success"})},[u]);x.useEffect(()=>{u&&y&&t.horasAcreditadas===0&&fe()},[u,y,fe,t.horasAcreditadas]);const Ne=s=>{s.preventDefault();const r=t.programarLanzamiento&&t.fechaPublicacion?t.fechaPublicacion:t.fechaInicio,i=Number(t.horasAcreditadas),S=!isNaN(i);if(!t.nombrePPS||!r||!t.orientacion||!S){j({message:"Por favor, complete los campos requeridos (Nombre, Fecha, OrientaciÃ³n, Horas).",type:"error"});return}const E=N.map(ae=>ae.trim()).filter(Boolean).join("; "),_=v.map(ae=>ae.trim()).filter(Boolean),Y={[X]:t.nombrePPS,[ie]:t.fechaInicio,[ca]:t.fechaFin,[be]:t.orientacion,[la]:Number(t.horasAcreditadas),[Me]:Number(t.cuposDisponibles),[Pe]:E,[U]:t.programarLanzamiento?"Programada":t.estadoConvocatoria,[ga]:"Relanzamiento Confirmado",[oa]:t.reqCertificadoTrabajo,[ra]:t.reqCv,[Ge]:t.direccion,[ba]:t.descripcion,[ma]:_,[pa]:t.requisitoObligatorio,[qa]:t.fechaInicioInscripcion,[Ga]:t.fechaFinInscripcion,[ha]:t.programarLanzamiento?t.fechaPublicacion:null,[xa]:t.mensajeWhatsApp,[ta]:t.actividadesLabel,[sa]:t.horariosFijos,[Va]:(y==null?void 0:y.id)||"recInstMock_nuevo"};G.mutate(Y)},ve=(s,r)=>{const i={};r==="cerrar"?i[U]="Cerrado":r==="abrir"?(i[U]="Abierta",i[ga]="Relanzamiento Confirmado"):r==="ocultar"&&(i[U]="Oculto"),ce.mutate({id:s,updates:i})},Ze=({targetDate:s})=>{const[r,i]=x.useState("");return x.useEffect(()=>{const S=()=>{const _=new Date().getTime(),ae=new Date(s).getTime()-_;if(ae<=0){i("Procesando...");return}const ye=Math.floor(ae/(1e3*60*60*24)),we=Math.floor(ae%(1e3*60*60*24)/(1e3*60*60)),He=Math.floor(ae%(1e3*60*60)/(1e3*60)),je=[];ye>0&&je.push(`${ye}d`),we>0&&je.push(`${we}h`),He>0&&je.push(`${He}m`),je.length===0&&je.push("< 1m"),i(je.join(" "))};S();const E=setInterval(S,6e4);return()=>clearInterval(E)},[s]),e.jsxs("div",{className:"flex items-center gap-1.5 px-2 py-1 bg-indigo-50 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-400 rounded-lg border border-indigo-100 dark:border-indigo-800/50",children:[e.jsx("span",{className:"material-icons !text-xs animate-pulse",children:"timer"}),e.jsx("span",{className:"text-[10px] font-black tracking-tight",children:r})]})},Ce=x.useCallback(s=>{const r=W(s[U]),i=r==="abierta"||r==="abierto",S=r==="oculto",E=r==="programada"||r==="programado",_=s[ha];return e.jsxs("div",{className:`bg-white dark:bg-slate-800/50 p-4 rounded-xl border transition-all hover:shadow-md ${i?"border-emerald-300 dark:border-emerald-800 ring-1 ring-emerald-100 dark:ring-emerald-900/30":E?"border-indigo-300 dark:border-indigo-800 ring-1 ring-indigo-50 dark:ring-indigo-900/20":S?"border-slate-200 dark:border-slate-700 opacity-75":"border-slate-200 dark:border-slate-700"} flex flex-col md:flex-row justify-between items-start md:items-center gap-4`,children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center flex-wrap gap-2 mb-1",children:[e.jsx("h4",{className:"font-bold text-slate-800 dark:text-slate-100",children:s[X]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("span",{className:`text-[10px] uppercase font-bold px-2 py-0.5 rounded-full border ${i?"bg-emerald-50 text-emerald-700 border-emerald-200":E?"bg-indigo-50 text-indigo-700 border-indigo-200":"bg-slate-100 text-slate-500 border-slate-200"}`,children:s[U]}),E&&_&&e.jsx(Ze,{targetDate:_})]})]}),e.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:[E?`PublicaciÃ³n: ${Z(_)}`:`Inicio: ${Z(s[ie]||"")}`," ","â€¢ OrientaciÃ³n: ",s[be]]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>k(s),className:"p-2 text-slate-500 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Editar",children:e.jsx("span",{className:"material-icons !text-xl",children:"edit"})}),S?e.jsx("button",{onClick:()=>ve(s.id,"cerrar"),className:"p-2 text-slate-500 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Hacer Visible (Cerrada)",children:e.jsx("span",{className:"material-icons !text-xl",children:"visibility"})}):i||E?e.jsx("button",{onClick:()=>ve(s.id,"cerrar"),className:"p-2 text-slate-500 hover:text-rose-600 hover:bg-rose-50 rounded-lg transition-colors",title:"Cerrar/Cancelar",children:e.jsx("span",{className:"material-icons !text-xl",children:E?"event_busy":"lock"})}):e.jsx("button",{onClick:()=>ve(s.id,"abrir"),className:"p-2 text-slate-500 hover:text-emerald-600 hover:bg-emerald-50 rounded-lg transition-colors",title:"Reabrir Convocatoria",children:e.jsx("span",{className:"material-icons !text-xl",children:"lock_open"})}),!S&&e.jsx("button",{onClick:()=>ve(s.id,"ocultar"),className:"p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg transition-colors",title:"Ocultar",children:e.jsx("span",{className:"material-icons !text-xl",children:"visibility_off"})}),e.jsx("button",{onClick:()=>{window.confirm("Â¿EstÃ¡s seguro de eliminar este lanzamiento? Esto no se puede deshacer y podrÃ­a afectar a los estudiantes inscriptos.")&&oe.mutate(s.id)},className:"p-2 text-slate-400 hover:text-rose-600 hover:bg-rose-50 rounded-lg transition-colors",title:"Eliminar Registro Permanentemente",children:e.jsx("span",{className:"material-icons !text-xl",children:"delete_forever"})})]})]},s.id)},[ve,oe]);return e.jsxs(ia,{title:d==="new"?"Nuevo Lanzamiento":"Historial de Lanzamientos",icon:d==="new"?"rocket_launch":"history",description:d==="new"?"Configura y publica una nueva convocatoria.":"Visualiza y administra convocatorias anteriores.",className:"border-blue-200 dark:border-blue-800/30",children:[B&&e.jsx(qe,{message:B.message,type:B.type,onClose:()=>j(null)}),e.jsx(Cs,{isOpen:n,onClose:()=>p(!1),onConfirm:ne.mutate,isLoading:ne.isPending}),!g&&e.jsx("div",{className:"mt-4",children:e.jsx(Ua,{tabs:[{id:"new",label:"Nuevo Lanzamiento",icon:"add_circle"},{id:"history",label:"Historial",icon:"history"}],activeTabId:d,onTabChange:m})}),e.jsx("div",{className:d==="new"?"block":"hidden",children:e.jsxs("form",{onSubmit:Ne,className:"mt-8 space-y-8 animate-fade-in",children:[e.jsxs("div",{className:`relative group ${M?"z-50":"z-30"}`,children:[e.jsx("div",{className:"absolute inset-0 overflow-hidden rounded-xl pointer-events-none",children:e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-blue-500/5 rounded-full -mr-10 -mt-10 pointer-events-none"})}),e.jsx("div",{className:"absolute -left-3 top-0 bottom-0 w-1 bg-gradient-to-b from-blue-400 to-blue-600 rounded-l-md shadow-sm"}),e.jsxs("div",{className:"pl-6 relative z-20",children:[e.jsxs("h3",{className:"text-lg font-bold text-slate-800 dark:text-white flex items-center gap-2 mb-4",children:[e.jsx("span",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-blue-100 dark:bg-blue-900 text-blue-600 dark:text-blue-300 text-sm font-bold shadow-sm border border-blue-200 dark:border-blue-800",children:"1"}),"InstituciÃ³n"]}),e.jsx("div",{className:"bg-slate-50 dark:bg-slate-800/50 p-6 rounded-xl border border-slate-200 dark:border-slate-700 shadow-sm relative",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-end",children:[e.jsxs("div",{className:"relative flex-grow w-full",children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider mb-2",children:"Buscar InstituciÃ³n"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"instiSearch",type:"text",value:q,onChange:s=>{ee(s.target.value),K(null),re(!0)},onFocus:()=>re(!0),placeholder:"Escribe para buscar...",className:"w-full h-11 pl-11 pr-4 text-lg font-medium bg-white dark:bg-slate-900 border-2 border-slate-200 dark:border-slate-600 rounded-xl focus:border-blue-500 focus:ring-0 transition-colors shadow-sm placeholder:font-normal",autoComplete:"off",required:!0}),e.jsx("span",{className:"absolute left-3.5 top-1/2 -translate-y-1/2 material-icons text-slate-400 !text-xl",children:"search"})]}),M&&Ie.length>0&&e.jsx("div",{className:"absolute z-[100] mt-2 w-full bg-white dark:bg-slate-800 rounded-xl shadow-xl border border-slate-200 dark:border-slate-600 overflow-hidden animate-fade-in-up max-h-60 overflow-y-auto",children:e.jsx("ul",{children:Ie.map(s=>e.jsxs("li",{onClick:()=>Se(s),className:"px-4 py-3 hover:bg-blue-50 dark:hover:bg-blue-900/30 cursor-pointer border-b border-slate-100 dark:border-slate-700 last:border-0 transition-colors flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-slate-100 dark:bg-slate-700 rounded-lg text-slate-500 dark:text-slate-300",children:e.jsx("span",{className:"material-icons !text-lg",children:"business"})}),e.jsx("div",{className:"flex-1",children:e.jsx("span",{className:"block text-slate-700 dark:text-slate-200 font-medium",children:s[Q]})})]},s.id))})})]}),e.jsx("div",{className:"flex-shrink-0 w-full md:w-auto",children:e.jsxs("button",{type:"button",onClick:()=>p(!0),className:"w-full md:w-auto h-[52px] px-6 bg-white dark:bg-slate-700 border-2 border-dashed border-blue-300 dark:border-blue-700 text-blue-600 dark:text-blue-300 rounded-xl font-bold hover:bg-blue-50 dark:hover:bg-blue-900/20 hover:border-blue-400 transition-all flex items-center justify-center gap-2",children:[e.jsx("span",{className:"material-icons !text-xl",children:"add"}),"Nueva InstituciÃ³n"]})})]})})]})]}),e.jsxs("div",{className:"relative group z-20",children:[e.jsx("div",{className:"absolute -left-3 top-0 bottom-0 w-1 bg-gradient-to-b from-indigo-400 to-indigo-600 rounded-l-md shadow-sm"}),e.jsxs("div",{className:"pl-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-slate-800 dark:text-white flex items-center gap-2 mb-4",children:[e.jsx("span",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-indigo-100 dark:bg-indigo-900 text-indigo-600 dark:text-indigo-300 text-sm font-bold shadow-sm border border-indigo-200 dark:border-indigo-800",children:"2"}),"Detalles BÃ¡sicos"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 bg-slate-50 dark:bg-slate-800/50 p-6 rounded-xl border border-slate-200 dark:border-slate-700",children:[e.jsx(se,{label:"Nombre PPS (Visible)",icon:"badge",children:e.jsx(H,{value:t.nombrePPS,onChange:O,name:"nombrePPS",placeholder:"Nombre visible de la convocatoria"})}),e.jsx(se,{label:"OrientaciÃ³n",icon:"school",children:e.jsxs(Ha,{value:t.orientacion,onChange:O,name:"orientacion",children:[e.jsx("option",{value:"",children:"Seleccionar..."}),za.map(s=>e.jsx("option",{value:s,children:s},s))]})}),e.jsx(se,{label:"DirecciÃ³n / Lugar",icon:"location_on",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"flex-1",children:e.jsx(H,{value:t.direccion,onChange:O,name:"direccion",placeholder:"Calle 123, CABA",disabled:t.direccion==="Modalidad Virtual"})}),e.jsx("div",{className:"flex items-center",children:e.jsx(pe,{label:"Online",checked:t.direccion==="Modalidad Virtual",onChange:s=>I(r=>({...r,direccion:s.target.checked?"Modalidad Virtual":""})),wrapperClassName:"bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 h-[46px]"})})]})}),e.jsx(se,{label:"Fecha Inicio",icon:"event_available",children:e.jsx(H,{type:"date",value:t.fechaInicio,onChange:O,name:"fechaInicio"})}),e.jsx(se,{label:"Fecha Fin (PrÃ¡ctica)",icon:"event_busy",children:e.jsx(H,{type:"date",value:t.fechaFin,onChange:O,name:"fechaFin"})}),e.jsx("div",{className:"col-span-1 md:col-span-2 lg:col-span-3 h-px bg-slate-200 dark:bg-slate-700 my-2"}),e.jsx(se,{label:"InscripciÃ³n Desde",icon:"app_registration",children:e.jsx(H,{type:"date",value:t.fechaInicioInscripcion,onChange:O,name:"fechaInicioInscripcion"})}),e.jsx(se,{label:"InscripciÃ³n Hasta",icon:"access_time_filled",children:e.jsx(H,{type:"date",value:t.fechaFinInscripcion,onChange:O,name:"fechaFinInscripcion"})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(se,{label:"Horas",icon:"schedule",children:e.jsx(H,{type:"number",value:t.horasAcreditadas,onChange:O,name:"horasAcreditadas"})}),e.jsx(se,{label:"Cupos",icon:"group",children:e.jsx(H,{type:"number",value:t.cuposDisponibles,onChange:O,name:"cuposDisponibles"})})]}),e.jsxs("div",{className:"flex flex-col gap-3 pt-2 md:col-span-2 lg:col-span-3",children:[e.jsxs("label",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider flex items-center gap-2",children:[e.jsx("span",{className:"material-icons text-slate-300 !text-sm",children:"verified_user"}),"Requisitos"]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-6",children:[e.jsx(pe,{label:"Cert. Trabajo",checked:t.reqCertificadoTrabajo,onChange:s=>I(r=>({...r,reqCertificadoTrabajo:s.target.checked}))}),e.jsx(pe,{label:"Solicitar CV",checked:t.reqCv,onChange:s=>I(r=>({...r,reqCv:s.target.checked}))})]})]}),e.jsxs("div",{className:"md:col-span-2 lg:col-span-3 flex flex-col md:flex-row gap-4 p-4 bg-blue-50 dark:bg-blue-900/10 rounded-xl border border-blue-100 dark:border-blue-800/30 mt-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(pe,{label:"Programar Lanzamiento AutomÃ¡tico (Fecha y Hora)",checked:t.programarLanzamiento,onChange:s=>I(r=>({...r,programarLanzamiento:s.target.checked}))}),e.jsx("p",{className:"text-[10px] text-slate-500 mt-1 pl-7",children:"Si activas esto, la convocatoria se publicarÃ¡ automÃ¡ticamente en la fecha y hora seleccionada."})]}),t.programarLanzamiento&&e.jsx("div",{className:"flex-1 animate-fade-in-up",children:e.jsx(H,{type:"datetime-local",value:t.fechaPublicacion,onChange:O,name:"fechaPublicacion",required:t.programarLanzamiento})})]})]})]})]}),e.jsxs("div",{className:"relative group z-20",children:[e.jsx("div",{className:"absolute -left-3 top-0 bottom-0 w-1 bg-gradient-to-b from-purple-400 to-purple-600 rounded-l-md shadow-sm"}),e.jsxs("div",{className:"pl-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("h3",{className:"text-lg font-bold text-slate-800 dark:text-white flex items-center gap-2",children:[e.jsx("span",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-purple-100 dark:bg-purple-900 text-purple-600 dark:text-purple-300 text-sm font-bold shadow-sm border border-purple-200 dark:border-purple-800",children:"3"}),"Contenido & Actividades"]})}),e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800/50 p-6 rounded-xl border border-slate-200 dark:border-slate-700 space-y-6",children:[e.jsxs("div",{className:"p-4 bg-purple-50 dark:bg-purple-900/10 rounded-xl border border-purple-100 dark:border-purple-800/30",children:[e.jsx("label",{className:"block text-xs font-bold text-purple-700 dark:text-purple-300 uppercase tracking-wider mb-2",children:"Material de Referencia / Programa (Para IA)"}),e.jsxs("div",{className:"flex gap-2 items-start",children:[e.jsx("textarea",{value:P,onChange:s=>z(s.target.value),placeholder:"Pega aquÃ­ el texto del convenio, programa o descripciÃ³n cruda. La IA lo usarÃ¡ para generar la tarjeta.",rows:3,className:"flex-1 px-3 py-2 text-xs bg-white dark:bg-slate-900 border border-purple-200 dark:border-purple-800 rounded-lg focus:ring-1 focus:ring-purple-500"}),e.jsxs("button",{type:"button",onClick:o,disabled:D||!P.trim(),className:`h-full px-4 rounded-lg transition-colors flex flex-col items-center justify-center gap-1 border ${D?"bg-slate-100 text-slate-400 border-slate-200":"bg-purple-100 hover:bg-purple-200 text-purple-700 dark:bg-purple-900/30 dark:hover:bg-purple-900/50 dark:text-purple-300 border-purple-200 dark:border-purple-800"}`,title:"Generar contenido automÃ¡ticamente",children:[e.jsx("span",{className:`material-icons !text-xl ${D?"animate-spin":""}`,children:D?"refresh":"auto_awesome"}),e.jsx("span",{className:"text-[10px] font-bold",children:D?"Cargando...":"Generar"})]})]}),e.jsx("p",{className:"text-[10px] text-slate-500 mt-2",children:'* Pega el texto y haz click en "Generar". La IA completarÃ¡ la DescripciÃ³n y Actividades. Luego usa "Previsualizar" para ver la tarjeta final.'})]}),e.jsx(se,{label:"DescripciÃ³n de la Propuesta",icon:"description",children:e.jsx("textarea",{name:"descripcion",value:t.descripcion,onChange:O,placeholder:"DescripciÃ³n detallada de la propuesta, objetivos y rol del practicante...",rows:4,className:"w-full px-4 py-3 bg-white dark:bg-slate-900 border border-slate-300 dark:border-slate-600 rounded-xl focus:ring-2 focus:ring-purple-500/50 focus:border-purple-500 transition-all text-sm"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2 ml-1",children:[e.jsxs("label",{className:"text-xs font-bold text-slate-500 dark:text-slate-400 uppercase tracking-wider flex items-center gap-2",children:[e.jsx("span",{className:"material-icons text-slate-300 !text-sm",children:"list_alt"}),"Contenido de la Lista"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-[10px] text-slate-400 font-bold uppercase",children:"TÃ­tulo:"}),e.jsx("input",{type:"text",name:"actividadesLabel",value:t.actividadesLabel,onChange:O,placeholder:"Ej: Actividades, Espacios...",className:"px-2 py-1 text-[10px] font-bold bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded focus:ring-1 focus:ring-purple-500 uppercase tracking-tight"})]})]}),e.jsxs("div",{className:"space-y-3",children:[v.map((s,r)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"w-8 h-10 flex items-center justify-center bg-slate-200 dark:bg-slate-700 rounded-lg text-xs font-bold text-slate-500",children:r+1}),e.jsx("input",{type:"text",value:s,onChange:i=>ke(r,i.target.value),placeholder:`Actividad ${r+1}`,className:"flex-1 px-4 py-2 bg-white dark:bg-slate-900 border border-slate-300 dark:border-slate-600 rounded-lg text-sm focus:border-purple-500 focus:outline-none"}),e.jsx("button",{type:"button",onClick:()=>ze(r),className:"p-2 hover:bg-rose-100 hover:text-rose-600 text-slate-400 rounded-lg transition-colors",children:e.jsx("span",{className:"material-icons !text-lg",children:"delete"})})]},r)),e.jsxs("button",{type:"button",onClick:_e,className:"text-sm font-bold text-purple-600 hover:text-purple-700 flex items-center gap-1 mt-2 px-2",children:[e.jsx("span",{className:"material-icons !text-lg",children:"add"})," Agregar Actividad"]})]})]}),e.jsx(se,{label:"Requisito Excluyente (Opcional)",icon:"campaign",children:e.jsx(H,{name:"requisitoObligatorio",value:t.requisitoObligatorio,onChange:O,placeholder:"Ej: Solo estudiantes con PsicoanÃ¡lisis aprobado"})})]})]})]}),e.jsxs("div",{className:"relative group z-20",children:[e.jsx("div",{className:"absolute -left-3 top-0 bottom-0 w-1 bg-gradient-to-b from-emerald-400 to-emerald-600 rounded-l-md shadow-sm"}),e.jsxs("div",{className:"pl-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-bold text-slate-800 dark:text-white flex items-center gap-2",children:[e.jsx("span",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-emerald-100 dark:bg-emerald-900 text-emerald-600 dark:text-emerald-300 text-sm font-bold shadow-sm border border-emerald-200 dark:border-emerald-800",children:"4"}),"Horarios"]}),e.jsxs("div",{className:"flex items-center gap-3 bg-emerald-50 dark:bg-emerald-900/10 px-4 py-2 rounded-xl border border-emerald-100 dark:border-emerald-800/30",children:[e.jsx(pe,{label:"Horarios Fijos (Obligatorios)",checked:t.horariosFijos,onChange:s=>I(r=>({...r,horariosFijos:s.target.checked})),labelClassName:"text-xs font-bold text-emerald-700 dark:text-emerald-300"}),e.jsx("span",{className:"material-icons text-emerald-400 !text-sm group-hover:text-emerald-500 cursor-help",title:"Si se marca, el estudiante no podrÃ¡ elegir uno de los horarios, sino que se asume que debe asistir a todos.",children:"info"})]})]}),e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800/50 p-6 rounded-xl border border-slate-200 dark:border-slate-700",children:[N.map((s,r)=>e.jsxs("div",{className:"flex gap-2 mb-3 last:mb-0",children:[e.jsx(H,{value:s,onChange:i=>ue(r,i.target.value),placeholder:"Ej: Lunes 9 a 12hs - Lic. PÃ©rez"}),e.jsx("button",{type:"button",onClick:()=>Qe(r),className:"p-2 hover:bg-rose-100 hover:text-rose-600 text-slate-400 rounded-lg transition-colors",children:e.jsx("span",{className:"material-icons !text-lg",children:"delete"})})]},r)),e.jsx(Ee,{variant:"secondary",onClick:Ue,type:"button",className:"mt-2 text-xs",children:"+ Agregar Horario"})]})]})]}),e.jsxs("div",{className:"pt-8 border-t border-slate-200 dark:border-slate-700 flex justify-end sticky bottom-6 z-40 bg-white/80 dark:bg-slate-900/80 backdrop-blur-sm p-4 rounded-xl",children:[e.jsx(Ee,{variant:"primary",type:"submit",isLoading:G.isPending,className:"h-14 px-8 text-lg shadow-xl shadow-blue-500/20",children:"Lanzar Convocatoria"}),e.jsx(Ee,{variant:"secondary",type:"button",onClick:l,className:"h-14 px-8 text-lg ml-4",children:"Previsualizar"})]}),w&&e.jsx("div",{className:"fixed inset-0 z-[1500] bg-slate-950/90 backdrop-blur-md flex items-center justify-center p-4 md:p-6 animate-fade-in",onClick:()=>F(!1),children:e.jsxs("div",{className:"w-full max-w-5xl max-h-[95vh] overflow-hidden bg-white dark:bg-slate-900 rounded-[28px] shadow-2xl relative flex flex-col border border-slate-200 dark:border-slate-800 animate-scale-in",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"p-5 border-b border-slate-100 dark:border-slate-800 flex justify-between items-center bg-white dark:bg-slate-900",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-blue-500/10 text-blue-600 flex items-center justify-center",children:e.jsx("span",{className:"material-icons !text-2xl",children:"visibility"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-black text-slate-900 dark:text-white",children:"PrevisualizaciÃ³n"}),e.jsx("p",{className:"text-xs text-slate-500",children:"Vista previa de la tarjeta y mensaje de WhatsApp"})]})]}),e.jsx("button",{type:"button",onClick:()=>F(!1),className:"w-9 h-9 rounded-full flex items-center justify-center text-slate-400 hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors",children:e.jsx("span",{className:"material-icons",children:"close"})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6 md:p-10",children:e.jsxs("div",{className:"flex flex-col gap-12 max-w-4xl mx-auto",children:[e.jsxs("div",{className:"w-full",children:[e.jsxs("h4",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"material-icons !text-xs text-blue-500",children:"credit_card"}),"Vista de Estudiante (Tarjeta)"]}),e.jsx("div",{className:"bg-slate-50 dark:bg-slate-950/50 rounded-2xl p-1 border border-slate-200 dark:border-slate-800 shadow-inner",children:e.jsx(vs,{id:"preview",nombre:t.nombrePPS||"Sin Nombre",orientacion:t.orientacion||"Sin OrientaciÃ³n",direccion:t.direccion||"Sin DirecciÃ³n",descripcion:t.descripcion||"Sin descripciÃ³n...",actividades:v.length?v:["Actividad 1...","Actividad 2..."],actividadesLabel:t.actividadesLabel,horasAcreditadas:String(t.horasAcreditadas||0),horariosCursada:N.join("; ")||"A confirmar",cupo:String(t.cuposDisponibles||0),requisitoObligatorio:t.requisitoObligatorio,reqCv:t.reqCv,horariosFijos:t.horariosFijos,timeline:{inscripcion:t.fechaInicioInscripcion&&t.fechaFinInscripcion?`${Z(t.fechaInicioInscripcion)} - ${Z(t.fechaFinInscripcion)}`:"Abierta/A definir",inicio:t.fechaInicio?Z(t.fechaInicio):"A confirmar",fin:t.fechaFin?Z(t.fechaFin):"A confirmar"},logoUrl:y==null?void 0:y[We],invertLogo:y==null?void 0:y[Je],status:"abierta"})})]}),e.jsx("div",{className:"h-px w-full bg-gradient-to-r from-transparent via-slate-200 dark:via-slate-800 to-transparent"}),e.jsxs("div",{className:"w-full flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h4",{className:"text-[10px] font-black text-emerald-500 uppercase tracking-widest flex items-center gap-2",children:[e.jsx("span",{className:"material-icons !text-xs",children:"chat"}),"Posteo de WhatsApp"]}),e.jsxs("button",{type:"button",onClick:()=>h(t.mensajeWhatsApp||""),className:`hover-lift flex items-center gap-2 px-5 py-2.5 rounded-xl font-bold text-sm transition-all shadow-sm ${he?"bg-emerald-500 text-white shadow-emerald-500/20":"bg-white dark:bg-slate-900 text-emerald-600 dark:text-emerald-400 border border-emerald-200 dark:border-emerald-800 hover:border-emerald-400"}`,children:[e.jsx("span",{className:"material-icons !text-lg",children:he?"done_all":"content_copy"}),he?"Copiado!":"Copiar para WhatsApp"]})]}),e.jsxs("div",{className:"bg-slate-900 rounded-[24px] overflow-hidden border border-slate-800 shadow-2xl",children:[e.jsxs("div",{className:"bg-slate-800/50 px-4 py-2 border-b border-slate-700/50 flex items-center gap-2",children:[e.jsxs("div",{className:"flex gap-1.5",children:[e.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-rose-500/50"}),e.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-amber-500/50"}),e.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-emerald-500/50"})]}),e.jsx("span",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-tight ml-2",children:"WhatsApp Preview"})]}),e.jsx("textarea",{value:t.mensajeWhatsApp,onChange:s=>I(r=>({...r,mensajeWhatsApp:s.target.value})),className:"w-full h-full min-h-[300px] bg-transparent text-emerald-100/90 text-sm leading-relaxed font-mono p-6 focus:ring-0 focus:outline-none resize-none",placeholder:"El mensaje de WhatsApp se generarÃ¡ automÃ¡ticamente..."})]})]})]})}),e.jsxs("div",{className:"p-5 border-t border-slate-100 dark:border-slate-800 bg-slate-50/50 dark:bg-slate-900/50 flex justify-between items-center gap-4",children:[e.jsxs("p",{className:"text-xs text-slate-400 flex items-center gap-2",children:[e.jsx("span",{className:"material-icons !text-sm",children:"info"}),t.programarLanzamiento?"Se agendarÃ¡ para la fecha seleccionada.":"Se publicarÃ¡ inmediatamente."]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ee,{variant:"secondary",type:"button",onClick:()=>F(!1),disabled:G.isPending,className:"!rounded-xl",children:"Seguir Editando"}),e.jsxs(Ee,{variant:"primary",isLoading:G.isPending,className:`h-12 px-8 shadow-xl !rounded-xl ${t.programarLanzamiento?"bg-indigo-600 hover:bg-indigo-700 shadow-indigo-500/20":"bg-blue-600 hover:bg-blue-700 shadow-blue-500/20"}`,onClick:s=>Ne(s),children:[e.jsx("span",{className:"material-icons mr-2 !text-lg",children:t.programarLanzamiento?"schedule_send":"rocket_launch"}),t.programarLanzamiento?"Programar":"Lanzar Ahora"]})]})]})]})})]})}),e.jsx("div",{className:d==="history"?"block":"hidden",children:e.jsxs("div",{className:"mt-8 space-y-8",children:[ge.length>0&&e.jsxs("div",{className:"animate-fade-in",children:[e.jsxs("h3",{className:"text-sm font-bold text-indigo-500 uppercase tracking-wider mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"material-icons !text-sm",children:"schedule_send"}),"Lanzamientos Programados"]}),e.jsx("div",{className:"space-y-4",children:ge.map(Ce)})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-bold text-slate-500 uppercase tracking-wider mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"material-icons !text-sm",children:"rocket_launch"}),"Convocatorias Activas"]}),e.jsx("div",{className:"space-y-4",children:R.length===0?e.jsx(Ke,{icon:"history_edu",title:"No hay convocatorias activas",message:"Crea un nuevo lanzamiento."}):R.map(Ce)})]}),b.length>0&&e.jsx(Ns,{title:"Convocatorias Ocultas / Archivadas",defaultOpen:!1,count:b.length,icon:"visibility_off",iconBgColor:"bg-slate-100 dark:bg-slate-800",iconColor:"text-slate-500 dark:text-slate-400",borderColor:"border-slate-200 dark:border-slate-700",children:e.jsx("div",{className:"space-y-4 pt-4",children:b.map(Ce)})})]})}),C&&e.jsx(gs,{isOpen:!!C,onClose:()=>k(null),record:C,tableConfig:As,onSave:(s,r)=>de.mutate({id:s,fields:r}),isSaving:de.isPending})]})},Le={TERMINO_CURSAR:100,CURSANDO_ELECTIVAS:50,BASE_FINALES:30,PER_HOUR:.5,TRABAJA:20},Ss=(a,g,f,m)=>{let d=0;const t=a[Ra]==="SÃ­",I=a[Da]==="SÃ­";t?d=Le.TERMINO_CURSAR:I?d=Le.CURSANDO_ELECTIVAS:d=Le.BASE_FINALES;const N=g*Le.PER_HOUR,c=m?Le.TRABAJA:0,v=f;return Math.round(d+N+c-v)},ks=(a=!1,g,f)=>{const[m,d]=x.useState(null),[t,I]=x.useState("selection"),[N,c]=x.useState(null),[v,T]=x.useState(null),[P,z]=x.useState(!1),D=Ta(),{data:$=[],isLoading:B}=De({queryKey:["openLaunchesForSelector",a],queryFn:async()=>{let o=[];return a?o=await le.getAll("lanzamientos_pps"):o=await L.lanzamientos.getAll(),o.map(l=>{const n={...l};return n[X]=Za(l[X]),n}).filter(l=>{const n=W(l[U]);return n==="abierta"||n==="abierto"})}});x.useEffect(()=>{if(f&&$.length>0&&!m){const o=$.find(l=>l.id===f);o&&d(o)}},[f,$,m]);const j=["candidatesForLaunch",m==null?void 0:m.id,a],{data:q=[],isLoading:ee,refetch:y}=De({queryKey:j,queryFn:async()=>{if(!m)return[];const o=m.id;let l=[];a?l=await le.getAll("convocatorias"):l=await L.convocatorias.getAll();const n=l.filter(u=>u[Te]===o);if(n.length===0)return[];const p=n.map(u=>u[te]).filter(Boolean);let C=[],k=[],w=[];a?[C,k,w]=await Promise.all([le.getAll("estudiantes",{id:p}),le.getAll("practicas",{[Xe]:p}),le.getAll("penalizaciones",{[ea]:p})]):[C,k,w]=await Promise.all([L.estudiantes.getAll({filters:{id:p}}),L.practicas.getAll({filters:{[Xe]:p}}),L.penalizaciones.getAll({filters:{[ea]:p}})]);const F=new Map(C.map(u=>[u.id,u]));return n.map(u=>{const A=u[te],R=A?F.get(A):null;if(!R)return null;const b=k.filter(O=>O[Xe]===A),ge=b.reduce((O,ue)=>O+(ue[Ja]||0),0),ne=b.length,ce=w.filter(O=>O[ea]===A).reduce((O,ue)=>O+(ue[Wa]||0),0),oe=!!u[Xa]||!!R[es],de=u[as]||R[ss],Ie=u[ts],Se=Ss(u,ge,ce,oe);return{enrollmentId:u.id,studentId:A,nombre:R[Ma]||"Desconocido",legajo:String(R[Pa]||""),correo:R[Fa]||"",status:u[Ye]||"Inscripto",terminoCursar:u[Ra]==="SÃ­",cursandoElectivas:u[Da]==="SÃ­",finalesAdeuda:u[os]||"",notasEstudiante:u[rs]||"",horarioSeleccionado:u[Ve]||"",totalHoras:ge,cantPracticas:ne,penalizacionAcumulada:ce,puntajeTotal:Se,trabaja:oe,certificadoTrabajo:de,cvUrl:Ie}}).filter(u=>u!==null).sort((u,A)=>A.puntajeTotal-u.puntajeTotal)},enabled:!!m}),K=x.useMemo(()=>q.filter(o=>W(o.status)==="seleccionado"),[q]),M=xe({mutationFn:async o=>{if(!m)return;const l=W(o.status)==="seleccionado";if(a){await new Promise(C=>setTimeout(C,300));const p=l?"Inscripto":"Seleccionado";return await le.update("convocatorias",o.enrollmentId,{[Ye]:p}),{success:!0,student:o}}return{...await Qa(o.enrollmentId,!l,o.studentId,m),student:o}},onMutate:async o=>{await D.cancelQueries({queryKey:j});const l=D.getQueryData(j);return D.setQueryData(j,n=>n?n.map(p=>{if(p.enrollmentId===o.enrollmentId){const C=W(p.status)==="seleccionado"?"Inscripto":"Seleccionado";return{...p,status:C}}return p}):[]),{previousCandidates:l}},onSuccess:(o,l,n)=>{o!=null&&o.success||(c({message:`Error: ${o==null?void 0:o.error}`,type:"error"}),n!=null&&n.previousCandidates&&D.setQueryData(j,n.previousCandidates)),D.invalidateQueries({queryKey:j})},onError:(o,l,n)=>{c({message:`Error: ${o.message}`,type:"error"}),n!=null&&n.previousCandidates&&D.setQueryData(j,n.previousCandidates)},onSettled:()=>T(null)}),re=xe({mutationFn:async({id:o,schedule:l})=>a?le.update("convocatorias",o,{[Ve]:l}):L.convocatorias.update(o,{[Ve]:l}),onSuccess:()=>{c({message:"Horario actualizado.",type:"success"}),y()}}),he=xe({mutationFn:async()=>{if(m)return a?le.update("lanzamientos_pps",m.id,{[U]:"Cerrado"}):L.lanzamientos.update(m.id,{[U]:"Cerrado"})},onSuccess:()=>{c({message:"Convocatoria cerrada exitosamente.",type:"success"}),D.invalidateQueries({queryKey:["openLaunchesForSelector"]}),D.invalidateQueries({queryKey:["launchHistory"]}),d(null)},onError:o=>c({message:`Error al cerrar: ${o.message}`,type:"error"})});return{selectedLanzamiento:m,setSelectedLanzamiento:d,viewMode:t,setViewMode:I,toastInfo:N,setToastInfo:c,updatingId:v,isClosingTable:P,openLaunches:$,isLoadingLaunches:B,candidates:q,isLoadingCandidates:ee,selectedCandidates:K,handleToggle:o=>{T(o.enrollmentId),M.mutate(o)},handleUpdateSchedule:(o,l)=>{re.mutate({id:o,schedule:l})},handleConfirmAndCloseTable:async()=>{if(m){z(!0);try{if(a)await le.update("lanzamientos_pps",m.id,{[U]:"Cerrado"});else{const o=K.map(async l=>js("seleccion",{studentName:l.nombre,studentEmail:l.correo,ppsName:m[X],schedule:l.horarioSeleccionado||"A confirmar"}));await Promise.all(o),await L.lanzamientos.update(m.id,{[U]:"Cerrado"})}c({message:"Mesa cerrada.",type:"success"}),g?setTimeout(()=>g(m.id),1500):(D.invalidateQueries({queryKey:["openLaunchesForSelector"]}),D.invalidateQueries({queryKey:["launchHistory"]}),d(null))}catch(o){c({message:`Error: ${o.message}`,type:"error"})}finally{z(!1)}}},closeLaunchMutation:he}},_s=({student:a,onToggleSelection:g,onUpdateSchedule:f,isUpdating:m,isReviewMode:d=!1})=>{const[t,I]=aa.useState(a.horarioSeleccionado),[N,c]=aa.useState(!1),v=W(a.status)==="seleccionado",T=()=>{N&&t!==a.horarioSeleccionado&&(f(a.enrollmentId,t),c(!1))};return e.jsx("div",{className:`rounded-xl border transition-all duration-200 ${v?"bg-emerald-50/60 border-emerald-200 dark:bg-emerald-900/10 dark:border-emerald-800 shadow-sm":"bg-white dark:bg-[#0B1120] border-slate-200 dark:border-white/5 hover:border-blue-300 dark:hover:border-blue-800"}`,children:e.jsxs("div",{className:"p-3 sm:p-4 flex flex-col lg:flex-row gap-4 items-start lg:items-center",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-[200px]",children:[e.jsx("div",{className:`flex-shrink-0 w-10 h-10 rounded-full flex items-center justify-center text-base font-black border shadow-sm ${a.puntajeTotal>=100?"bg-amber-100 text-amber-700 border-amber-200 dark:bg-amber-900/30 dark:text-amber-400 dark:border-amber-800":"bg-slate-100 text-slate-600 border-slate-200 dark:bg-slate-800 dark:text-slate-400 dark:border-slate-700"}`,title:"Puntaje Total",children:a.puntajeTotal}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h4",{className:"font-bold text-slate-800 dark:text-slate-100 text-sm truncate leading-tight",title:a.nombre,children:a.nombre}),e.jsx("div",{className:"mt-1",children:e.jsxs("span",{className:"inline-flex items-center gap-1 text-[11px] font-bold text-blue-700 dark:text-blue-300 bg-blue-50 dark:bg-blue-900/20 px-2 py-0.5 rounded border border-blue-100 dark:border-blue-800",children:[e.jsx("span",{className:"material-icons !text-[11px]",children:"schedule"})," ",a.totalHoras," ","hs acumuladas"]})})]})]}),e.jsxs("div",{className:"flex-1 w-full lg:w-auto flex flex-wrap items-center gap-2 border-t lg:border-t-0 lg:border-l border-slate-100 dark:border-slate-800 pt-3 lg:pt-0 lg:pl-4 min-h-[32px]",children:[a.terminoCursar?e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-[10px] font-bold uppercase bg-emerald-100 text-emerald-700 border border-emerald-200 dark:bg-emerald-900/20 dark:text-emerald-400 dark:border-emerald-800 whitespace-nowrap",children:"TerminÃ³ Cursada"}):a.cursandoElectivas?e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-[10px] font-bold uppercase bg-indigo-100 text-indigo-700 border border-indigo-200 dark:bg-indigo-900/20 dark:text-indigo-300 dark:border-indigo-800 whitespace-nowrap",children:"Cursando Electivas"}):e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-[10px] font-bold uppercase bg-slate-100 text-slate-600 border border-slate-200 dark:bg-slate-800 dark:text-slate-400 dark:border-slate-700 whitespace-nowrap",children:"Cursando"}),a.cantPracticas===0&&e.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-[10px] font-bold uppercase bg-fuchsia-100 text-fuchsia-700 border border-fuchsia-200 dark:bg-fuchsia-900/20 dark:text-fuchsia-300 dark:border-fuchsia-800 whitespace-nowrap shadow-sm",children:[e.jsx("span",{className:"material-icons !text-[10px] mr-1",children:"new_releases"}),"Sin PrÃ¡cticas"]}),a.terminoCursar&&e.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-[10px] font-bold uppercase border whitespace-nowrap ${a.finalesAdeuda?"bg-orange-50 text-orange-700 border-orange-200 dark:bg-orange-900/20 dark:text-orange-400 dark:border-orange-800":"bg-slate-50 text-slate-500 border-slate-200 dark:bg-slate-800/50 dark:text-slate-500 dark:border-slate-700"}`,children:a.finalesAdeuda?`Adeuda: ${a.finalesAdeuda}`:"Sin Finales"}),a.trabaja&&e.jsxs("a",{href:a.certificadoTrabajo||"#",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-2 py-0.5 rounded text-[10px] font-bold uppercase bg-blue-50 text-blue-700 border border-blue-200 dark:bg-blue-900/20 dark:text-blue-300 dark:border-blue-800 whitespace-nowrap hover:bg-blue-100 transition-colors",title:"Ver certificado de trabajo",onClick:P=>!a.certificadoTrabajo&&P.preventDefault(),children:[e.jsx("span",{className:"material-icons !text-[10px] mr-1",children:"work"}),"Trabaja"]}),a.cvUrl&&e.jsxs("a",{href:a.cvUrl,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center px-2 py-0.5 rounded text-[10px] font-bold uppercase bg-cyan-50 text-cyan-700 border border-cyan-200 dark:bg-cyan-900/20 dark:text-cyan-300 dark:border-cyan-800 whitespace-nowrap hover:bg-cyan-100 transition-colors",title:"Ver Curriculum Vitae",children:[e.jsx("span",{className:"material-icons !text-[10px] mr-1",children:"description"}),"CV"]}),a.penalizacionAcumulada>0&&e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-[10px] font-bold uppercase bg-rose-50 text-rose-700 border border-rose-200 dark:bg-rose-900/20 dark:text-rose-300 dark:border-rose-800 whitespace-nowrap",children:"PenalizaciÃ³n Activa"}),a.notasEstudiante&&e.jsxs("div",{className:"inline-flex items-start gap-1.5 bg-yellow-50 dark:bg-yellow-900/10 border border-yellow-100 dark:border-yellow-800/30 rounded px-2 py-1 text-xs text-slate-700 dark:text-slate-300 w-full break-words mt-1",children:[e.jsx("span",{className:"font-bold text-[10px] uppercase text-yellow-700 dark:text-yellow-500 shrink-0 mt-[1px]",children:"Nota:"}),e.jsxs("span",{className:"italic leading-tight whitespace-pre-wrap",children:['"',a.notasEstudiante,'"']})]})]}),e.jsxs("div",{className:"flex items-center gap-2 w-full lg:w-auto pt-2 lg:pt-0 border-t lg:border-t-0 border-slate-100 dark:border-slate-800",children:[e.jsx("div",{className:"flex-grow lg:w-40",children:e.jsx("input",{type:"text",value:t,onChange:P=>{I(P.target.value),c(!0)},onBlur:T,className:"w-full text-xs px-2.5 py-2 rounded-lg border border-slate-300 dark:border-slate-700 bg-slate-50 dark:bg-black/30 focus:ring-1 focus:ring-blue-500 outline-none transition-all placeholder:text-slate-400 dark:text-white",placeholder:"Asignar horario..."})}),e.jsx("button",{onClick:()=>g(a),disabled:m,className:`flex-shrink-0 w-10 h-10 rounded-lg flex items-center justify-center transition-all active:scale-95 shadow-sm ${v?"bg-emerald-600 text-white hover:bg-emerald-700 ring-2 ring-emerald-100 dark:ring-emerald-900":"bg-white dark:bg-slate-800 border border-slate-300 dark:border-slate-600 text-slate-400 hover:text-blue-600 hover:border-blue-300 dark:hover:border-blue-500 dark:hover:text-blue-400"}`,title:v?"Deseleccionar":"Seleccionar Alumno",children:m?e.jsx("div",{className:"w-4 h-4 border-2 border-current border-t-transparent rounded-full animate-spin"}):e.jsx("span",{className:"material-icons !text-xl",children:v?"check":"add"})})]})]})})},ys=({isTestingMode:a=!1,onNavigateToInsurance:g,preSelectedLaunchId:f})=>{const{selectedLanzamiento:m,setSelectedLanzamiento:d,viewMode:t,setViewMode:I,toastInfo:N,setToastInfo:c,updatingId:v,isClosingTable:T,openLaunches:P,isLoadingLaunches:z,candidates:D,isLoadingCandidates:$,selectedCandidates:B,handleToggle:j,handleUpdateSchedule:q,handleConfirmAndCloseTable:ee}=ks(a,g,f),[y,K]=x.useState(!1);return z?e.jsx(na,{}):m?e.jsxs("div",{className:"animate-fade-in-up space-y-6",children:[N&&e.jsx(qe,{message:N.message,type:N.type,onClose:()=>c(null)}),e.jsx(Es,{isOpen:y,title:"Â¿Cerrar Mesa de InscripciÃ³n?",message:`Se enviarÃ¡n correos automÃ¡ticos de confirmaciÃ³n a los ${B.length} alumnos seleccionados. Â¿Deseas proceder con el cierre definitivo de esta convocatoria?`,onConfirm:()=>{ee(),K(!1)},onClose:()=>K(!1),confirmText:"Confirmar Cierre",type:"info"}),e.jsxs("div",{className:"bg-white dark:bg-[#0F172A] p-4 rounded-xl border border-slate-200 dark:border-white/10 shadow-sm",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>d(null),className:"p-2 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-full transition-colors text-slate-500 dark:text-slate-400",children:e.jsx("span",{className:"material-icons",children:"arrow_back"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-slate-800 dark:text-slate-100",children:m[X]}),e.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:["Cupos: ",m[Me]," | Postulantes:"," ",D.length," | Seleccionados: ",B.length]})]})]}),t==="selection"?e.jsx("div",{className:"flex gap-2",children:e.jsx("button",{onClick:()=>I("review"),className:"bg-blue-600 text-white px-5 py-2 rounded-lg font-bold text-sm shadow-md hover:bg-blue-700 transition-colors dark:bg-blue-700 dark:hover:bg-blue-600",children:"Revisar y Cerrar"})}):e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>I("selection"),className:"text-slate-600 dark:text-slate-300 font-bold px-4 py-2 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-lg transition-colors",children:"Volver"}),e.jsxs("button",{onClick:()=>K(!0),disabled:T,className:"bg-emerald-600 text-white px-5 py-2 rounded-lg font-bold text-sm flex items-center gap-2 shadow-md hover:bg-emerald-700 transition-colors disabled:opacity-70 dark:bg-emerald-700 dark:hover:bg-emerald-600",children:[T?e.jsx("div",{className:"w-4 h-4 border-2 border-white/50 border-t-white rounded-full animate-spin"}):e.jsx("span",{className:"material-icons !text-base",children:"lock"}),T?"Cerrando...":"Confirmar Cierre"]})]})]}),e.jsx("div",{className:"flex items-center gap-2 border-t border-slate-100 dark:border-slate-800 pt-3",children:e.jsxs("div",{className:"text-xs px-3 py-1.5 bg-blue-50 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300 rounded-lg border border-blue-100 dark:border-blue-800 flex items-center gap-2 group relative cursor-help",children:[e.jsx("span",{className:"font-bold",children:"Criterio:"})," Puntaje descendente",e.jsx("span",{className:"material-icons !text-sm opacity-70",children:"help"}),e.jsxs("div",{className:"absolute left-0 top-full mt-2 w-64 p-3 bg-slate-800 text-white text-xs rounded-lg shadow-xl opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none z-50",children:[e.jsx("p",{className:"font-bold mb-1 border-b border-slate-600 pb-1",children:"FÃ³rmula de Puntaje:"}),e.jsxs("ul",{className:"space-y-1 list-disc pl-3",children:[e.jsxs("li",{children:["TerminÃ³ de cursar: ",e.jsx("strong",{children:"+100 pts"})]}),e.jsxs("li",{children:["Cursando electivas: ",e.jsx("strong",{children:"+50 pts"})]}),e.jsxs("li",{children:["Trabaja (c/certificado): ",e.jsx("strong",{children:"+20 pts"})]}),e.jsxs("li",{children:["Adeuda finales: ",e.jsx("strong",{children:"+30 pts"})]}),e.jsxs("li",{children:["Horas acumuladas: ",e.jsx("strong",{children:"+0.5 pts/hora"})]}),e.jsxs("li",{children:["Penalizaciones: ",e.jsx("strong",{children:"- Puntos"})]})]}),e.jsx("div",{className:"absolute -top-1 left-4 w-2 h-2 bg-slate-800 rotate-45"})]})]})})]}),$?e.jsx(na,{}):e.jsxs("div",{className:"space-y-3",children:[(t==="selection"?D:B).map(M=>e.jsx(_s,{student:M,onToggleSelection:j,onUpdateSchedule:q,isUpdating:v===M.enrollmentId,isReviewMode:t==="review"},M.enrollmentId)),t==="review"&&B.length===0&&e.jsx(Ke,{icon:"group_off",title:"Sin Seleccionados",message:"No has seleccionado ningÃºn estudiante para esta mesa."})]})]}):e.jsxs("div",{className:"animate-fade-in-up",children:[N&&e.jsx(qe,{message:N.message,type:N.type,onClose:()=>c(null)}),e.jsx("h3",{className:"text-xl font-bold mb-2 text-slate-800 dark:text-slate-100",children:"Seleccionar Convocatoria Abierta"}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400 mb-6",children:"Elige una convocatoria para gestionar sus postulantes."}),P.length===0?e.jsx(Ke,{icon:"event_busy",title:"Sin Convocatorias Abiertas",message:"No hay lanzamientos activos en este momento."}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:P.map(M=>{const re=ls(M[be]);return e.jsxs("button",{onClick:()=>d(M),className:"text-left p-5 rounded-xl border border-slate-200 dark:border-white/5 bg-white dark:bg-[#0F172A] shadow-sm hover:shadow-lg hover:border-blue-400 dark:hover:border-blue-600 dark:hover:shadow-blue-900/10 transition-all group relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-transparent to-slate-50 dark:to-slate-900/50 opacity-0 group-hover:opacity-100 transition-opacity"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsx("span",{className:re.tag,children:M[be]}),e.jsxs("span",{className:"text-xs font-bold bg-emerald-100 dark:bg-emerald-900/30 text-emerald-700 dark:text-emerald-400 border border-emerald-200 dark:border-emerald-800 px-2.5 py-1 rounded-full",children:[M[Me]," Cupos"]})]}),e.jsx("h4",{className:"font-bold text-lg text-slate-800 dark:text-slate-100 group-hover:text-blue-600 dark:group-hover:text-blue-400 transition-colors line-clamp-2 min-h-[3.5rem]",children:M[X]}),e.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400 mt-3 flex items-center gap-1.5 pt-3 border-t border-slate-100 dark:border-slate-800",children:[e.jsx("span",{className:"material-icons !text-base opacity-70",children:"calendar_today"}),"Inicio:"," ",e.jsx("span",{className:"font-medium text-slate-700 dark:text-slate-300",children:Z(M[ie])})]})]})]},M.id)})})]})},ws=({showModal:a,isTestingMode:g=!1,preSelectedLanzamientoId:f})=>{const[m,d]=x.useState("selection"),[t,I]=x.useState([]),[N,c]=x.useState(new Set),[v,T]=x.useState([]),[P,z]=x.useState(!1),[D,$]=x.useState(""),[B,j]=x.useState(null),q=x.useCallback(async()=>{if(z(!0),$("Cargando convocatorias..."),I([]),g){I([{id:"mock_conv_1",createdTime:"",[Oe]:"Hospital Mock",[Ye]:"Seleccionado",[me]:"2024-01-01",[fa]:"2024-06-01",[te]:"student_1"}]),z(!1);return}try{const[h,o]=await Promise.all([L.convocatorias.getAll({filters:{[Ye]:"Seleccionado"},sort:[{field:me,direction:"desc"}]}),L.lanzamientos.getAll()]),l=new Map(o.map(C=>[C.id,C])),n=new Map;h.forEach(C=>{const k=C[Te],w=k?l.get(k):void 0,F=C[Oe]||(w==null?void 0:w[X])||"Sin Nombre",V=C[me]||(w==null?void 0:w[ie])||"N/A",u=k||`${F}||${V}`;n.has(u)||n.set(u,{...C,id:u,[Oe]:F,[me]:V,[te]:[],[Te]:k});const A=n.get(u),R=C[te];if(R){const b=A[te]||[];b.includes(R)||(b.push(R),A[te]=b)}});const p=Array.from(n.values()).sort((C,k)=>{const w=new Date(C[me]||"1900-01-01").getTime();return new Date(k[me]||"1900-01-01").getTime()-w}).slice(0,20);I(p)}catch(h){a("Error de Carga",`No se pudieron cargar las convocatorias: ${h.message}`)}finally{z(!1),$("")}},[g,a]);x.useEffect(()=>{q().then(()=>{f&&(c(new Set([f])),setTimeout(()=>ee(new Set([f])),500))})},[q,f]);const ee=async h=>{const o=h||N;if(z(!0),$("Procesando estudiantes..."),g){T([{studentId:"s1",nombre:"Juan",apellido:"Test",dni:"123",legajo:"111",correo:"j@t.com",telefono:"111",institucion:"Hosp Test",direccion:"Calle 1",periodo:"Ene-Jun",horario:"9-18",cargo:"Estudiante",lugarCompleto:"Hosp Test - Calle 1",duracionCompleta:"Periodo: Ene-Jun. Horario: 9-18",tutor:"Tutor 1",orientacion:"Clinica"}]),d("review"),z(!1);return}const l=t.filter(p=>o.has(p.id)),n=new Set;if(l.forEach(p=>{(p[te]||[]).forEach(C=>n.add(C))}),n.size===0){h||a("Sin Estudiantes","No hay estudiantes en las convocatorias seleccionadas."),z(!1);return}try{const[p,C,k]=await Promise.all([L.estudiantes.getAll(),L.lanzamientos.getAll(),L.convocatorias.getAll()]),w=new Map(p.map(A=>[A.id,A])),F=new Map(C.map(A=>[A.id,A])),V=new Map;k.forEach(A=>{const R=A[te],b=A[Te];R&&b&&V.set(`${R}-${b}`,A)});const u=[];for(const A of l){const R=A[Te],b=R?F.get(R):void 0,ge=A[te]||[];for(const ne of ge){const G=w.get(ne);if(!G)continue;const ce=V.get(`${ne}-${R}`),oe=(b==null?void 0:b[X])||A[Oe]||"N/A",de=(b==null?void 0:b[Ge])||A[is]||"",Ie=(b==null?void 0:b[ie])||A[me],Se=(b==null?void 0:b[ca])||A[fa],ue=!!(b!=null&&b[sa])?(b==null?void 0:b[Pe])||"A definir":(ce==null?void 0:ce[Ve])||(b==null?void 0:b[Pe])||"A definir",Ue=(b==null?void 0:b[be])||A[ns]||"General",Qe=G[Ma]||"";let ke=String(G[cs]??""),_e=String(G[ds]??"");if(!ke||!_e){const Ce=us(Qe);ke=Ce.nombre,_e=Ce.apellido}const ze=`Del ${Z(Ie)} al ${Z(Se)}`;let fe="N/A";const Ne=W(Ue);Ne.includes("clinica")?fe="Selva Estrella":Ne.includes("educacional")?fe="Franco Pedraza":(Ne.includes("laboral")||Ne.includes("comunitaria"))&&(fe="Cynthia Rossi");const ve=de?`${oe} - ${de}`:oe,Ze=`PerÃ­odo: ${ze}. Horario: ${ue}`;u.push({studentId:ne,nombre:ke,apellido:_e,dni:String(G[ps]||"N/A"),legajo:String(G[Pa]||"N/A"),correo:String(G[Fa]||"N/A"),telefono:ms(String(G[xs]||"")),institucion:oe,direccion:de,periodo:ze,horario:ue,cargo:"Estudiante",lugarCompleto:ve,duracionCompleta:Ze,tutor:fe,orientacion:Ue})}}T(u),d("review")}catch(p){console.error(p),a("Error","OcurriÃ³ un error al procesar los datos.")}finally{z(!1),$("")}},y=async()=>{if(v.length!==0)try{const h=(await Be(async()=>{const{default:k}=await import("./exceljs.min-B8t_jxSM.js").then(w=>w.e);return{default:k}},__vite__mapDeps([0,1,2,3]),import.meta.url)).default,o=new h.Workbook,l=v.reduce((k,w)=>{const F=w.institucion;return k[F]||(k[F]=[]),k[F].push(w),k},{});for(const k in l){const w=l[k],F=k.replace(/[\\/?*[\]]/g,"").substring(0,25)||"PPS",V=o.addWorksheet(F);V.columns=[{header:"APELLIDO",key:"apellido",width:25},{header:"NOMBRE",key:"nombre",width:25},{header:"DNI",key:"dni",width:15},{header:"LEGAJO",key:"legajo",width:15},{header:"CORREO",key:"correo",width:30},{header:"TELEFONO",key:"telefono",width:20},{header:"HORARIO",key:"horario",width:30}],V.addRows(w),V.getRow(1).font={bold:!0},V.getRow(1).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFD9E2F3"}}}const n=await o.xlsx.writeBuffer(),p=new Blob([n],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});(await Be(()=>import("./FileSaver.min-iB6v0HDW.js").then(k=>k.F),__vite__mapDeps([4,1,2]),import.meta.url)).saveAs(p,`Listado_Alumnos_${new Date().toISOString().split("T")[0]}.xlsx`),j({message:"Excel generado correctamente.",type:"success"})}catch(h){console.error("Error generating Excel:",h),a("Error","No se pudo generar el Excel: "+h.message)}},K=async h=>{try{z(!0),$("Descargando plantilla de Supabase...");const{data:o,error:l}=await Fe.storage.from("documentos_seguros").download("Seguro (2).xlsx");if(l){console.warn("Error downloading specific file, trying alternative...",l);const{data:n,error:p}=await Fe.storage.from("documentos_seguros").download("Seguro.xlsx");if(p)throw p;if(!n)throw new Error("No se encontrÃ³ la plantilla en el servidor.");const C=await Be(()=>import("./FileSaver.min-iB6v0HDW.js").then(w=>w.F),__vite__mapDeps([4,1,2]),import.meta.url),k=h.replace(/[\\/?*[\]]/g,"").substring(0,50);C.saveAs(n,`Seguro - ${k}.xlsx`)}else{if(!o)throw new Error("El archivo descargado estÃ¡ vacÃ­o.");const n=await Be(()=>import("./FileSaver.min-iB6v0HDW.js").then(C=>C.F),__vite__mapDeps([4,1,2]),import.meta.url),p=h.replace(/[\\/?*[\]]/g,"").substring(0,50);n.saveAs(o,`Seguro - ${p}.xlsx`)}j({message:"Plantilla descargada. Ahora copia los datos.",type:"success"})}catch(o){console.error("Error detallado descarga:",o);let l="Error desconocido al descargar la plantilla.";o.message?l=o.message:o.error_description?l=o.error_description:o.error&&(l=typeof o.error=="string"?o.error:JSON.stringify(o.error)),a("Error de Descarga",`No se pudo descargar la plantilla.

Detalle: ${l}`)}finally{z(!1),$("")}},M=h=>{const l=h.map(n=>[n.apellido,n.nombre,n.dni,n.legajo,n.cargo,n.lugarCompleto,n.duracionCompleta].join("	")).join(`
`);navigator.clipboard.writeText(l).then(()=>{j({message:`${h.length} filas copiadas. Pegar en el Excel de Seguro (celda A2).`,type:"success"})}).catch(n=>{console.error("Failed to copy",n),j({message:"Error al copiar los datos.",type:"error"})})},re=h=>{const o=`Reporte de Seguro - ${h}`,n=`mailto:mesadeayuda.patagonia@uflouniversidad.edu.ar?subject=${encodeURIComponent(o)}&body=${encodeURIComponent(`Hola Sergio,

Te adjunto el seguro de la PPS.

Saludos.`)}`;window.open(n,"_blank"),j({message:"Ventana de correo abierta. Adjunta el Excel generado.",type:"success"})},he=h=>{const o=new Set(N);o.has(h)?o.delete(h):o.add(h),c(o)},Ae=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-slate-800 dark:text-slate-100",children:"Paso 1: Seleccionar Convocatorias"}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400",children:"Seleccione las convocatorias con alumnos seleccionados para procesar."})]}),P?e.jsx(na,{}):t.length===0?e.jsx(Ke,{icon:"event_busy",title:"Sin Convocatorias",message:"No se encontraron convocatorias recientes con alumnos seleccionados."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full min-w-[600px] text-sm text-left",children:[e.jsx("thead",{className:"text-xs text-slate-500 uppercase bg-slate-100 dark:bg-slate-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3 w-10",children:e.jsx("span",{className:"sr-only",children:"Select"})}),e.jsx("th",{className:"p-3",children:"InstituciÃ³n (Lanzamiento)"}),e.jsx("th",{className:"p-3 text-center",children:"Alumnos"}),e.jsx("th",{className:"p-3",children:"Fecha Inicio"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-200 dark:divide-slate-700",children:t.map(h=>{var o;return e.jsxs("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-800/50",children:[e.jsx("td",{className:"p-3",children:e.jsx(pe,{id:`conv-${h.id}`,name:"conv",checked:N.has(h.id),onChange:()=>he(h.id),label:""})}),e.jsx("td",{className:"p-3 font-medium text-slate-900 dark:text-white",children:h[Oe]}),e.jsx("td",{className:"p-3 text-center",children:e.jsx("span",{className:"inline-flex items-center justify-center px-2 py-1 text-xs font-bold leading-none text-blue-100 bg-blue-600 rounded-full",children:((o=h[te])==null?void 0:o.length)||0})}),e.jsx("td",{className:"p-3 text-slate-500 dark:text-slate-400",children:Z(h[me])})]},h.id)})})]})}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsxs("button",{onClick:()=>ee(),disabled:N.size===0||P,className:"bg-blue-600 text-white font-bold py-2.5 px-6 rounded-lg shadow-md hover:bg-blue-700 disabled:bg-slate-400 disabled:cursor-not-allowed flex items-center gap-2",children:[e.jsx("span",{children:"Continuar"}),e.jsx("span",{className:"material-icons !text-base",children:"arrow_forward"})]})})]}),J=()=>{const h=v.reduce((o,l)=>(o[l.institucion]||(o[l.institucion]=[]),o[l.institucion].push(l),o),{});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-slate-800 dark:text-slate-100",children:"Paso 2: Generar DocumentaciÃ³n"}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400",children:"1. Descarga plantilla. 2. Copia datos. 3. EnvÃ­a a AdministraciÃ³n."})]}),e.jsxs("button",{onClick:()=>d("selection"),className:"text-slate-500 hover:text-slate-700 font-medium flex items-center gap-1",children:[e.jsx("span",{className:"material-icons !text-base",children:"arrow_back"})," Volver"]})]}),Object.entries(h).map(([o,l],n)=>e.jsx(ia,{title:o,description:`${l.length} alumnos asignados`,children:e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-3 p-4 bg-slate-50 dark:bg-slate-700/30 rounded-lg border border-slate-200 dark:border-slate-700",children:[e.jsxs("button",{onClick:()=>K(o),disabled:P,className:"bg-indigo-600 text-white hover:bg-indigo-700 px-4 py-2 rounded-md text-sm font-bold flex items-center gap-2 transition-colors shadow-sm",children:[e.jsx("span",{className:"material-icons !text-lg",children:"download"}),"1. Descargar Plantilla"]}),e.jsxs("button",{onClick:()=>M(l),className:"bg-white dark:bg-slate-700 text-slate-700 dark:text-slate-200 border border-slate-300 dark:border-slate-600 hover:bg-slate-100 dark:hover:bg-slate-600 px-4 py-2 rounded-md text-sm font-bold flex items-center gap-2 transition-colors shadow-sm",children:[e.jsx("span",{className:"material-icons !text-lg",children:"content_copy"}),"2. Copiar Datos"]}),e.jsxs("button",{onClick:()=>re(o),className:"bg-emerald-600 text-white hover:bg-emerald-700 px-4 py-2 rounded-md text-sm font-bold flex items-center gap-2 transition-colors shadow-sm",children:[e.jsx("span",{className:"material-icons !text-lg",children:"send"}),"3. Enviar a Sergio"]})]}),e.jsxs("details",{className:"group",children:[e.jsxs("summary",{className:"cursor-pointer text-sm font-medium text-slate-500 dark:text-slate-400 list-none flex items-center gap-2",children:[e.jsx("span",{className:"material-icons transition-transform group-open:rotate-90",children:"chevron_right"}),"Ver lista de alumnos (",l.length,")"]}),e.jsx("ul",{className:"divide-y divide-slate-100 dark:divide-slate-700 text-sm mt-2 pl-6 border-l-2 border-slate-200 dark:border-slate-700",children:l.map(p=>e.jsxs("li",{className:"py-2",children:[e.jsxs("span",{className:"font-semibold",children:[p.apellido,", ",p.nombre]}),e.jsxs("span",{className:"text-slate-500 ml-2",children:["DNI: ",p.dni]})]},p.studentId))})]})]})},n)),e.jsx("div",{className:"flex justify-end pt-4 border-t border-slate-200 dark:border-slate-700",children:e.jsxs("button",{onClick:y,className:"bg-slate-600 text-white font-bold py-2.5 px-6 rounded-lg shadow-md hover:bg-slate-700 flex items-center gap-2",children:[e.jsx("span",{className:"material-icons !text-base",children:"table_view"}),"Descargar Listado General"]})})]})};return e.jsxs(ia,{title:"Generador de Seguros y Listas",icon:"shield",children:[B&&e.jsx(qe,{message:B.message,type:B.type,onClose:()=>j(null)}),e.jsx("div",{className:"mt-4 pt-4 border-t border-slate-200 dark:border-slate-700",children:m==="selection"?Ae():J()})]})},$s=({isTestingMode:a=!1})=>{const[g]=bs(),[f,m]=x.useState("nuevo"),[d,t]=x.useState(null),{showModal:I}=hs(),N=[{id:"nuevo",label:"Nuevo Lanzamiento",icon:"add_circle"},{id:"seleccionador",label:"Seleccionador",icon:"how_to_reg"},{id:"seguro",label:"Seguro",icon:"shield"},{id:"historial",label:"Historial",icon:"history"}];x.useEffect(()=>{const v=g.get("tab");v&&N.some(T=>T.id===v)&&m(v)},[g]);const c=v=>{t(v),m("seguro")};return e.jsxs(e.Fragment,{children:[e.jsx(Ua,{tabs:N,activeTabId:f,onTabChange:m}),e.jsxs("div",{className:"mt-6",children:[f==="nuevo"&&e.jsx(La,{forcedTab:"new",isTestingMode:a}),f==="seleccionador"&&e.jsx(ys,{isTestingMode:a,onNavigateToInsurance:c,preSelectedLaunchId:g.get("launchId")}),f==="seguro"&&e.jsx(ws,{showModal:I,isTestingMode:a,preSelectedLanzamientoId:d}),f==="historial"&&e.jsx(La,{forcedTab:"history",isTestingMode:a})]})]})};export{$s as default};
