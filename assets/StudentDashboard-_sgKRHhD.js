import{R as Q,j as e,r as o,n as _,bS as De,bT as Ie,bU as sa,bV as Ce,e as oe,I as K,bd as Me,bh as Pe,aE as Re,bW as I,C as ie,N as de,b as ze,i as Ue,a1 as ne,ax as we,F as V,ak as ta,M as P,af as ra,au as Ee,$ as Se,al as na,an as la,az as Ae,ao as ia,ap as oa,Q as ye,a3 as da,aB as _e,G as $,bX as ca,bg as xa,bf as ma,u as ua,c as $e,a0 as Z,Y as G,b4 as U,f as ha,g as ba,ba as pa,O as ga,bY as Na,as as fa,k as ja,l as va,m as ka,o as Ia,q as Ca,s as wa,t as Ea,v as Sa,w as Aa,x as ya,y as _a,z as Oa,B as Ta,D as La,E as Fa,H as Da,J as Oe,K as Ma,L as Pa}from"./index-ZXlslG1z.js";import{A as Ra}from"./types-Cg8ilULs.js";import{S as za}from"./Select-DhRNnplj.js";import{A as Ua,a as J,F as He,S as $a,P as Ha}from"./PreSolicitudCheckModal-J-N_Aj9Q.js";import{T as qa}from"./Tabs-3YiwyxBG.js";import{P as Ba}from"./ProfileView-CEvSVS12.js";import{C as Va}from"./ConvocatoriaCardPremium-Cd-vXGWP.js";import"./proxy-BFxRqQFC.js";const qe=Q.memo(({value:a,max:s,size:d=180,strokeWidth:r=12,className:h=""})=>{const m=s>0?Math.max(0,Math.min(a/s*100,100)):0,u=m>=100,b=d+20,N=b/2,c=(d-r)/2,j=2*Math.PI*c,g=j-m/100*j;return e.jsxs("div",{className:`relative flex items-center justify-center ${h}`,style:{width:b,height:b},children:[u&&e.jsx("div",{className:"absolute inset-0 bg-emerald-500/20 rounded-full blur-2xl animate-pulse-glow"}),e.jsxs("svg",{width:b,height:b,className:"transform -rotate-90 relative z-10",children:[e.jsx("circle",{cx:N,cy:N,r:c,stroke:"currentColor",strokeWidth:r,fill:"transparent",className:"text-slate-200 dark:text-slate-700/30"}),e.jsx("circle",{cx:N,cy:N,r:c,stroke:u?"#10b981":"#3b82f6",strokeWidth:r,fill:"transparent",strokeDasharray:j,strokeDashoffset:g,strokeLinecap:"round",className:"transition-all duration-1000 ease-out drop-shadow-md"})]}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none z-20",children:e.jsx("div",{className:"text-center",children:e.jsxs("span",{className:`text-4xl font-black tracking-tighter ${u?"text-emerald-600 dark:text-emerald-400":"text-slate-800 dark:text-white"}`,children:[Math.round(m),"%"]})})})]})});qe.displayName="ProgressCircle";const Be=Q.memo(({selectedOrientacion:a,onOrientacionChange:s,showSaveConfirmation:d})=>e.jsxs("div",{className:"relative group min-w-[200px]",children:[d&&e.jsxs("div",{className:"absolute -top-6 left-0 text-[10px] font-black text-emerald-600 dark:text-emerald-400 uppercase tracking-tighter flex items-center gap-1 animate-fade-in-up",children:[e.jsx("span",{className:"material-icons !text-xs",children:"check_circle"})," Guardado"]}),e.jsx("p",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest mb-2",children:"Especialidad"}),e.jsxs(za,{id:"orientacion-elegida-select","aria-label":"Seleccionar orientaci贸n principal",value:a,onChange:r=>s(r.target.value),className:"text-xs font-bold w-full bg-white dark:bg-slate-900 border-slate-200 dark:border-white/10 rounded-xl py-2",children:[e.jsx("option",{value:"",children:" Seleccionar..."}),Ra.map(r=>e.jsx("option",{value:r,children:r},r))]})]}));Be.displayName="OrientacionSelector";const Za=a=>{const s=_(a);return s.includes("clinica")?"bg-emerald-100 text-emerald-800 border-emerald-200 dark:bg-emerald-500/10 dark:text-emerald-300 dark:border-emerald-500/20":s.includes("educacional")||s.includes("educacion")?"bg-sky-100 text-sky-800 border-sky-200 dark:bg-sky-500/10 dark:text-sky-300 dark:border-sky-500/20":s.includes("laboral")||s.includes("trabajo")?"bg-amber-100 text-amber-800 border-amber-200 dark:bg-amber-500/10 dark:text-amber-300 dark:border-amber-500/20":s.includes("comunitaria")||s.includes("social")?"bg-violet-100 text-violet-800 border-violet-200 dark:bg-violet-500/10 dark:text-violet-300 dark:border-violet-500/20":"bg-slate-100 text-slate-700 border-slate-200 dark:bg-slate-800 dark:text-slate-300 dark:border-slate-700"},Te=({icon:a,label:s,value:d,subValue:r,isCompleted:h,children:m,colorClass:u="text-blue-600"})=>e.jsxs("div",{className:`
        relative overflow-hidden rounded-[2rem] p-6 flex flex-col justify-between h-full transition-all duration-300
        glass-panel glass-card-hover group border
        ${h?"border-emerald-200 bg-emerald-50/50 dark:bg-emerald-900/5 dark:border-emerald-900/30":"border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900/40"}
    `,children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("div",{className:`
                p-3 rounded-2xl flex items-center justify-center shrink-0 transition-transform group-hover:scale-110 duration-300 shadow-sm
                ${h?"bg-emerald-100 text-emerald-600 dark:bg-emerald-500/20 dark:text-emerald-400":"bg-slate-50 dark:bg-slate-800 "+u}
            `,children:e.jsx("span",{className:"material-icons !text-2xl",children:a})}),h&&e.jsx("div",{className:"text-emerald-500 animate-fade-in bg-emerald-100 dark:bg-emerald-900/30 rounded-full p-1",children:e.jsx("span",{className:"material-icons !text-lg block",children:"check"})})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-bold text-slate-400 dark:text-slate-500 uppercase tracking-widest mb-1 truncate",children:s}),e.jsxs("div",{className:"flex items-baseline gap-1.5",children:[e.jsx("span",{className:`text-3xl md:text-4xl font-black tracking-tight ${h?"text-emerald-700 dark:text-emerald-400":"text-slate-900 dark:text-white"}`,children:d}),r&&e.jsx("span",{className:"text-sm font-bold text-slate-400 dark:text-slate-500",children:r})]}),m&&e.jsx("div",{className:"mt-3",children:m})]})]}),Ga=({criterios:a,selectedOrientacion:s,handleOrientacionChange:d,showSaveConfirmation:r,onRequestFinalization:h,isLoading:m=!1,informeTasks:u=[]})=>{const[f,b]=o.useState(!1),N=o.useMemo(()=>u.some(n=>n.informeSubido&&(n.nota==="Sin calificar"||n.nota==="Entregado (sin corregir)")),[u]),c=o.useMemo(()=>a.cumpleHorasTotales&&a.cumpleRotacion&&a.cumpleHorasOrientacion&&!a.tienePracticasPendientes&&!N,[a,N]),j=o.useMemo(()=>{const n=new Set,t=[];for(const O of a.orientacionesUnicas){const C=_(O);n.has(C)||(n.add(C),t.push(O))}return t},[a.orientacionesUnicas]),g=()=>{b(!0)};if(m)return e.jsx(De,{});const v=Math.min(100,Math.round(a.horasTotales/Ie*100)),x=()=>e.jsxs("div",{className:"bg-white/80 dark:bg-[#0F172A]/80 backdrop-blur-xl rounded-[2rem] p-6 border border-slate-200/60 dark:border-slate-800 shadow-xl shadow-slate-200/40 dark:shadow-none relative overflow-hidden mb-6",children:[e.jsx("div",{className:"absolute -top-24 -right-24 w-64 h-64 bg-blue-500/10 rounded-full blur-[80px] pointer-events-none"}),e.jsx("div",{className:"absolute -bottom-24 -left-24 w-64 h-64 bg-indigo-500/10 rounded-full blur-[80px] pointer-events-none"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex justify-between items-end mb-4 pb-4 border-b border-slate-100 dark:border-white/5",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-extrabold text-slate-400 uppercase tracking-widest mb-1",children:"Horas Acumuladas"}),e.jsxs("div",{className:"flex items-baseline gap-1.5",children:[e.jsx("span",{className:`text-6xl font-black tracking-tighter leading-none ${c?"text-transparent bg-clip-text bg-gradient-to-br from-emerald-500 to-teal-600 dark:from-emerald-400 dark:to-teal-500":"text-slate-900 dark:text-white"}`,children:Math.round(a.horasTotales)}),e.jsx("span",{className:"text-lg font-bold text-slate-400 dark:text-slate-600",children:"hs"})]})]}),e.jsx("div",{className:`w-12 h-12 rounded-2xl flex items-center justify-center border-2 shadow-sm ${c?"border-emerald-500 text-emerald-600 bg-emerald-50 dark:bg-emerald-900/20":"border-slate-100 text-slate-300 bg-slate-50 dark:border-slate-700 dark:bg-slate-800"}`,children:e.jsx("span",{className:"material-icons !text-2xl",children:c?"verified":"hourglass_top"})})]}),e.jsx("div",{className:"mb-4",children:c?e.jsxs("p",{className:"text-xs text-emerald-600 dark:text-emerald-400 font-bold leading-tight flex items-start gap-1.5",children:[e.jsx("span",{className:"material-icons !text-sm mt-0.5",children:"check_circle"}),e.jsx("span",{children:"隆Felicitaciones! Has completado todos los requisitos."})]}):e.jsxs("p",{className:"text-xs text-slate-600 dark:text-slate-400 font-medium leading-tight",children:["Has completado el"," ",e.jsxs("strong",{className:"text-blue-600 dark:text-blue-400",children:[v,"%"]})," de las horas requeridas para tu acreditaci贸n."]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:`flex items-center justify-between gap-3 px-4 py-3 rounded-xl border transition-colors ${a.cumpleRotacion?"bg-emerald-50/80 border-emerald-100 text-emerald-900 dark:bg-emerald-900/20 dark:border-emerald-800 dark:text-emerald-300":"bg-white/60 border-slate-100 text-slate-700 dark:bg-indigo-900/10 dark:border-indigo-800 dark:text-indigo-200"}`,children:[e.jsx("div",{children:e.jsx("span",{className:"text-xs font-bold uppercase tracking-wider block",children:"Rotaci贸n de reas"})}),e.jsxs("span",{className:"text-sm font-black font-mono opacity-100",children:[a.orientacionesCursadasCount," / ",Ce]})]}),e.jsxs("div",{className:`flex items-center justify-between gap-3 px-4 py-3 rounded-xl border transition-colors ${a.cumpleHorasOrientacion?"bg-emerald-50/80 border-emerald-100 text-emerald-900 dark:bg-emerald-900/20 dark:border-emerald-800 dark:text-emerald-300":"bg-white/60 border-slate-100 text-slate-700 dark:bg-indigo-900/10 dark:border-indigo-800 dark:text-indigo-200"}`,children:[e.jsx("div",{children:e.jsx("span",{className:"text-xs font-bold uppercase tracking-wider block",children:s||"Especialidad"})}),e.jsx("span",{className:"text-sm font-black font-mono opacity-100",children:s?`${Math.round(a.horasOrientacionElegida)}hs`:"-"})]})]})]})]});return e.jsxs("section",{className:"animate-fade-in-up",children:[e.jsx("div",{className:"block lg:hidden",children:e.jsx(x,{})}),e.jsxs("div",{className:"hidden lg:grid grid-cols-3 gap-6",children:[e.jsxs("div",{className:"col-span-2 relative overflow-hidden rounded-[2.5rem] bg-gradient-to-br from-white to-slate-50 dark:from-[#0B1120] dark:to-[#0f172a] text-slate-900 dark:text-white shadow-xl shadow-slate-200/50 dark:shadow-black/50 border border-slate-200/80 dark:border-slate-800",children:[e.jsx("div",{className:"absolute top-0 right-0 w-[500px] h-[500px] bg-gradient-to-bl from-blue-100/60 to-transparent dark:from-blue-900/20 rounded-full blur-[120px] -mr-40 -mt-40 pointer-events-none opacity-80"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-full h-full bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-[0.03] dark:opacity-[0.07] mix-blend-overlay pointer-events-none"}),e.jsxs("div",{className:"relative z-10 grid grid-cols-1 md:grid-cols-12 gap-8 items-center p-8 sm:p-10 h-full",children:[e.jsxs("div",{className:"md:col-span-7 flex flex-col justify-center h-full space-y-8",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-lg bg-white/60 dark:bg-white/5 border border-slate-200 dark:border-white/10 backdrop-blur-md shadow-sm mb-4",children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${c?"bg-emerald-500 animate-pulse":"bg-blue-500"}`}),e.jsx("span",{className:"text-xs font-bold uppercase tracking-widest text-slate-500 dark:text-slate-400",children:"Progreso General"})]}),e.jsxs("div",{className:"flex items-baseline gap-1",children:[e.jsx("span",{className:"text-7xl sm:text-8xl font-black tracking-tighter leading-none text-slate-900 dark:text-white drop-shadow-sm",children:Math.round(a.horasTotales)}),e.jsx("span",{className:"text-2xl sm:text-3xl text-slate-400 dark:text-slate-500 font-bold",children:"hs"})]}),c?e.jsxs("p",{className:"text-lg text-emerald-600 dark:text-emerald-400 font-bold mt-2 max-w-sm leading-relaxed flex items-start gap-2",children:[e.jsx("span",{className:"material-icons mt-1 !text-lg",children:"check_circle"}),"隆Felicitaciones! Has completado todos los requisitos para tu acreditaci贸n."]}):e.jsxs("p",{className:"text-lg text-slate-600 dark:text-slate-400 font-medium mt-2 max-w-sm leading-relaxed",children:["Has completado el"," ",e.jsxs("strong",{className:"text-blue-600 dark:text-blue-400",children:[v,"%"]})," ","de las horas requeridas para tu acreditaci贸n."]})]}),e.jsx("div",{className:"pt-2",children:e.jsx("button",{onClick:g,className:`
                                    group relative inline-flex items-center justify-center gap-3 px-8 py-3.5 rounded-xl font-bold text-sm transition-all duration-300 shadow-md hover:shadow-xl hover:-translate-y-0.5 active:scale-95 border w-full sm:w-auto
                                    ${c?"bg-slate-900 dark:bg-white text-white dark:text-slate-900 border-transparent":"bg-white dark:bg-slate-800 text-slate-600 dark:text-slate-200 border-slate-200 dark:border-slate-700 hover:border-blue-300 dark:hover:border-slate-600"}
                                `,children:c?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"material-icons text-emerald-400 !text-xl",children:"verified"}),e.jsx("span",{children:"Solicitar Acreditaci贸n"})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Tr谩mite de Acreditaci贸n"}),e.jsx("span",{className:"material-icons !text-lg text-slate-400 group-hover:translate-x-1 transition-transform",children:"arrow_forward"})]})})})]}),e.jsxs("div",{className:"md:col-span-5 flex items-center justify-center relative",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-tr from-blue-50 to-indigo-50 dark:from-slate-800/50 dark:to-slate-900/50 rounded-full blur-2xl transform scale-90"}),e.jsx("div",{className:"relative z-10 scale-110",children:e.jsx(qe,{value:a.horasTotales,max:Ie,size:220,strokeWidth:16,className:"drop-shadow-lg"})})]})]})]}),e.jsxs("div",{className:"col-span-1 flex flex-col gap-6",children:[e.jsx("div",{className:"flex-1",children:s?e.jsx(Te,{icon:"psychology",label:`Especialidad: ${s}`,value:Math.round(a.horasOrientacionElegida),subValue:`/ ${sa}`,isCompleted:a.cumpleHorasOrientacion,colorClass:"text-purple-600 dark:text-purple-400"}):e.jsx("div",{className:"h-full glass-panel rounded-[2rem] p-6 flex flex-col justify-center items-center text-center hover:border-blue-300 dark:hover:border-blue-700 transition-all group cursor-pointer relative overflow-hidden border-dashed border-2 border-slate-300 dark:border-slate-700 bg-slate-50/50 dark:bg-slate-900/50",children:e.jsxs("div",{className:"relative z-10 w-full",children:[e.jsx("div",{className:"mb-4 text-slate-400 group-hover:text-blue-500 transition-colors transform group-hover:scale-110 duration-300",children:e.jsx("span",{className:"material-icons !text-5xl",children:"add_task"})}),e.jsx(Be,{selectedOrientacion:s,onOrientacionChange:d,showSaveConfirmation:r})]})})}),e.jsx("div",{className:"flex-1",children:e.jsx(Te,{icon:"cached",label:"reas Rotadas",value:a.orientacionesCursadasCount,subValue:`/ ${Ce}`,isCompleted:a.cumpleRotacion,colorClass:"text-amber-600 dark:text-amber-500",children:e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:j.length>0?j.map(n=>e.jsx("span",{className:`px-2.5 py-1 rounded-lg text-[10px] font-bold border uppercase tracking-wide shadow-sm ${Za(n)}`,children:n},n)):e.jsx("span",{className:"text-xs text-slate-400 italic",children:"Sin 谩reas registradas"})})})})]})]}),e.jsx(Ua,{isOpen:f,onClose:()=>b(!1),onConfirm:()=>{b(!1),h()},criterios:a,informeTask:u[0]})]})},le=Q.memo(Ga),Ja=({studentName:a,isLoading:s})=>{const[d,r]=o.useState(""),[h,m]=o.useState("");if(o.useEffect(()=>{const f=new Date().getHours();f<12&&f>=5?r("Buenos d铆as"):f<20&&f>=12?r("Buenas tardes"):r("Buenas noches");const b={weekday:"long",year:"numeric",month:"long",day:"numeric"},N=new Date().toLocaleDateString("es-ES",b);m(N.charAt(0).toUpperCase()+N.slice(1))},[]),s)return e.jsx("div",{className:"h-24 w-full bg-slate-100 dark:bg-slate-800/50 rounded-3xl animate-pulse mb-8"});const u=(a==null?void 0:a.split(" ")[0])||"Estudiante";return e.jsxs("div",{className:"relative mb-8 pt-4 px-2",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-baseline justify-between gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("h1",{className:"text-4xl sm:text-5xl md:text-6xl font-black text-slate-900 dark:text-white tracking-tight leading-tight",children:[e.jsxs("span",{className:"block md:inline",children:[d,e.jsx("span",{className:"hidden md:inline",children:","})]}),e.jsx("span",{className:"hidden md:inline",children:" "}),e.jsxs("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-blue-600 via-indigo-500 to-purple-600 dark:from-blue-400 dark:via-indigo-400 dark:to-purple-400",children:[u,"."]})]})}),e.jsx("div",{className:"hidden md:block text-right",children:e.jsxs("div",{className:"inline-flex items-center gap-2 px-5 py-2.5 rounded-full bg-white/60 dark:bg-slate-800/50 border border-slate-200 dark:border-slate-700 text-slate-500 dark:text-slate-400 text-sm font-bold shadow-sm backdrop-blur-md",children:[e.jsx("span",{className:"material-icons !text-lg text-blue-500",children:"calendar_today"}),e.jsx("span",{children:h})]})})]}),e.jsx("div",{className:"hidden md:block mt-6 h-px w-full bg-gradient-to-r from-slate-200 via-slate-100 to-transparent dark:from-slate-800 dark:via-slate-900"})]})},W=Q.memo(Ja),Wa=({practicas:a,criterios:s,isLoading:d,selectedOrientacion:r,studentNameForPanel:h,studentDetails:m})=>{const{showModal:u}=oe(),f=()=>{if(d||!s||!a||!h||!m){u("Error","Los datos del estudiante a煤n se est谩n cargando. Int茅ntalo de nuevo en un momento.");return}const b=m[K]||"N/A",N=a.length>0?a.map(g=>{const v=g[Me],x=Array.isArray(v)?v.join(", "):v,n=g[Pe]||"N/A",t=g[Re]||0;return`- *${x}* (${n}): ${t} hs.`}).join(`
`):"No hay pr谩cticas registradas.",c=r?`*Horas en ${r}:* ${Math.round(s.horasOrientacionElegida)} / 70 hs`:"No se ha seleccionado una orientaci贸n principal.",j=`*Resumen Acad茅mico - ${h}*
*Legajo:* ${b}

*Avance de PPS:*
- *Horas Totales:* ${Math.round(s.horasTotales)} / 250 hs
- ${c}
- *Rotaci贸n de Orientaciones:* ${s.orientacionesCursadasCount} / 3 (${s.orientacionesUnicas.join(", ")||"N/A"})

*Historial de Pr谩cticas:*
${N}
`;navigator.clipboard.writeText(j).then(()=>{u("Copiado","El resumen del alumno ha sido copiado al portapapeles.")},g=>{console.error("Error al copiar: ",g),u("Error","No se pudo copiar el texto. Revisa los permisos del navegador.")})};return e.jsx("button",{onClick:f,className:`fixed bottom-6 right-6 z-50 w-14 h-14 bg-blue-600 text-white rounded-full shadow-lg flex items-center justify-center
                 transition-all duration-300 ease-in-out transform hover:scale-110 hover:shadow-xl focus:outline-none focus:ring-4 focus:ring-blue-300`,"aria-label":"Exportar resumen a WhatsApp",children:e.jsx("span",{className:"material-icons !text-2xl",children:"share"})})},Qa=()=>e.jsxs("div",{className:"space-y-8 animate-fade-in w-full max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsx(W,{isLoading:!0,studentDetails:null}),e.jsx("div",{className:"hidden md:block",children:e.jsx(De,{})}),e.jsxs("div",{className:"w-full",children:[e.jsx("div",{className:"border-b border-slate-200 dark:border-slate-700/60 mb-8",children:e.jsxs("div",{className:"flex space-x-8 px-2 overflow-x-auto",children:[e.jsx("div",{className:"pb-4 border-b-2 border-blue-500/50",children:e.jsx(I,{className:"h-5 w-24"})}),e.jsx("div",{className:"pb-4 opacity-50",children:e.jsx(I,{className:"h-5 w-32"})}),e.jsx("div",{className:"pb-4 opacity-50",children:e.jsx(I,{className:"h-5 w-28"})}),e.jsx("div",{className:"pb-4 opacity-50",children:e.jsx(I,{className:"h-5 w-20"})})]})}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"xl:col-span-2 space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx(I,{className:"h-7 w-48"})}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-2xl p-6 border border-slate-200 dark:border-slate-700 shadow-sm relative overflow-hidden",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsxs("div",{className:"w-full",children:[e.jsx(I,{className:"h-6 w-3/4 mb-3"}),e.jsx(I,{className:"h-4 w-1/3"})]}),e.jsx(I,{className:"h-8 w-24 rounded-full"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-8",children:[e.jsx(I,{className:"h-12 rounded-xl"}),e.jsx(I,{className:"h-12 rounded-xl"})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(I,{className:"h-7 w-40 mb-2"}),e.jsx("div",{className:"bg-white dark:bg-slate-800/50 rounded-2xl p-5 border border-slate-200 dark:border-slate-700 space-y-4",children:[1,2,3].map(a=>e.jsxs("div",{className:"flex gap-4 py-2",children:[e.jsx(I,{className:"h-12 w-12 rounded-lg flex-shrink-0"}),e.jsxs("div",{className:"space-y-2 w-full",children:[e.jsx(I,{className:"h-4 w-3/4"}),e.jsx(I,{className:"h-3 w-1/2"})]})]},a))})]})]})]})]}),Ka=({error:a,onRetry:s})=>e.jsx("div",{className:"mt-8 animate-fade-in-up",children:e.jsx(ie,{className:"border-red-200 bg-red-50/50",children:e.jsx(de,{icon:"error",title:"Error al Cargar Datos",message:a,action:s?e.jsx("button",{onClick:s,className:"mt-4 px-6 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors duration-200 focus:outline-none focus:ring-4 focus:ring-red-300",children:"Reintentar"}):void 0})})}),Ve=({lanzamientos:a,institutionAddressMap:s,institutionLogoMap:d,enrollmentMap:r,completedLanzamientoIds:h,onInscribir:m})=>{const{openSeleccionadosModal:u,showModal:f}=oe(),{authenticatedUser:b}=ze(),N=(b==null?void 0:b.legajo)==="99999",c=Ue({mutationFn:async x=>{if(N){const t=(await ye.getAll("convocatorias",{[da]:x.id})).filter(w=>_(w[we])==="seleccionado");if(t.length===0)return null;const O=t.map(w=>w[_e]),C=await ye.getAll("estudiantes",{id:O}),A=new Map(C.map(w=>[w.id,w])),l={};return t.forEach(w=>{const p=w[Ae]||"No especificado",E=A.get(w[_e]);E&&(l[p]||(l[p]=[]),l[p].push({nombre:E[$],legajo:E[K]}))}),l}return ca(x)},onSuccess:(x,n)=>{const t=n[V]||"Convocatoria";u(x,t)},onError:x=>f("Error",x.message)}),j=a.filter(x=>{const n=_(x[ne]);return n==="abierta"||n==="abierto"}),g=a.filter(x=>{const n=_(x[ne]);return n==="cerrada"||n==="cerrado"}),v=x=>{const{key_suffix:n,...t}=x,O=r.get(t.id),C=O?O[we]:null,A=t[V]||"",l=A.split(" - ")[0].trim(),w=t[ta]||s.get(_(A))||s.get(_(l)),p=d&&(d.get(_(A))||d.get(_(l))),E=_(A),M=h.has(t.id)||h.has(E);return e.jsx(Va,{id:t.id,logoUrl:p==null?void 0:p.url,invertLogo:p==null?void 0:p.invert,nombre:t[V]||"Convocatoria",orientacion:t[oa]||"General",direccion:w||"Direcci贸n no disponible",descripcion:t.descripcion_larga||"Descripci贸n de la propuesta no disponible.",actividades:Array.isArray(t.actividades_lista)?t.actividades_lista:t.actividades_lista?[String(t.actividades_lista)]:[],horasAcreditadas:String(t[ia]||0),horariosCursada:t[Ae]||"A definir",cupo:String(t[la]||0),requisitoObligatorio:t.requisito_obligatorio||"",reqCv:t[na]||!1,timeline:{inscripcion:t[Ee]&&t[Se]?`${P(t[Ee])} - ${P(t[Se])}`:"Abierta",inicio:P(t.fecha_inicio),fin:P(t.fecha_finalizacion)},status:t[ne],estadoInscripcion:C,isCompleted:M,onInscribirse:()=>m(t),onVerConvocados:()=>c.mutate(t),horariosFijos:!!t[ra]},`${t.id}-${n||"default"}`)};return e.jsxs("div",{className:"space-y-12 animate-fade-in",children:[j.length>0?e.jsxs("div",{children:[e.jsxs("h3",{className:"text-sm font-bold text-slate-500 dark:text-slate-400 uppercase tracking-widest mb-6 flex items-center gap-2 pl-1",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-indigo-500"})," Convocatorias Abiertas"]}),e.jsx("div",{className:"grid grid-cols-1 gap-6",children:j.map((x,n)=>v({...x,key_suffix:`active-${n}`}))})]}):null,g.length>0?e.jsxs("div",{className:"pt-4",children:[e.jsxs("h3",{className:"text-sm font-bold text-slate-500 dark:text-slate-400 uppercase tracking-widest mb-6 flex items-center gap-2 pl-1",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-slate-400"})," Convocatorias Finalizadas"]}),e.jsx("div",{className:"grid grid-cols-1 gap-6 opacity-85 hover:opacity-100 transition-opacity",children:g.map((x,n)=>v({...x,key_suffix:`closed-${n}`}))})]}):null,j.length===0&&g.length===0&&e.jsx(de,{icon:"upcoming",title:"No hay convocatorias abiertas",message:"Por el momento, no hay procesos de inscripci贸n disponibles. 隆Vuelve a consultar pronto!"})]})},Le=({studentDetails:a,criterios:s,practicas:d})=>a?e.jsxs("div",{className:"p-8 font-sans bg-white text-black",children:[e.jsx("style",{children:`
        @media print {
          body { -webkit-print-color-adjust: exact; print-color-adjust: exact; }
          .printable-section { break-inside: avoid; }
        }
      `}),e.jsxs("header",{className:"mb-8 text-center border-b-2 border-gray-300 pb-4 printable-section",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Reporte de Pr谩cticas Profesionales Supervisadas"}),e.jsx("h2",{className:"text-xl mt-2 text-gray-700",children:a[$]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Legajo: ",a[K]]})]}),e.jsxs("section",{className:"mb-8 printable-section",children:[e.jsx("h3",{className:"text-xl font-bold mb-4 border-b border-gray-200 pb-2",children:"Resumen de Criterios"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-4xl font-extrabold text-blue-600",children:Math.round(s.horasTotales)}),e.jsx("p",{className:"text-sm text-gray-600",children:"Horas Totales (de 250)"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-4xl font-extrabold text-blue-600",children:s.orientacionesCursadasCount}),e.jsx("p",{className:"text-sm text-gray-600",children:"Rotaciones (de 3)"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-4xl font-extrabold text-blue-600",children:Math.round(s.horasOrientacionElegida)}),e.jsx("p",{className:"text-sm text-gray-600",children:"Horas en Orientaci贸n (de 70)"})]})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-3",children:["Orientaciones cursadas: ",s.orientacionesUnicas.join(", ")||"N/A"]})]}),e.jsxs("section",{className:"printable-section",children:[e.jsx("h3",{className:"text-xl font-bold mb-4 border-b border-gray-200 pb-2",children:"Historial de Pr谩cticas"}),e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-100",children:[e.jsx("th",{className:"p-2 border border-gray-300",children:"Instituci贸n"}),e.jsx("th",{className:"p-2 border border-gray-300",children:"Especialidad"}),e.jsx("th",{className:"p-2 border border-gray-300",children:"Per铆odo"}),e.jsx("th",{className:"p-2 border border-gray-300 text-right",children:"Horas"})]})}),e.jsx("tbody",{children:d.length>0?d.map((r,h)=>{const m=r[Me],u=Array.isArray(m)?m.join(", "):m;return e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("td",{className:"p-2 border border-gray-300",children:u||"N/A"}),e.jsx("td",{className:"p-2 border border-gray-300",children:r[Pe]||"N/A"}),e.jsxs("td",{className:"p-2 border border-gray-300",children:[P(r[xa])," -"," ",P(r[ma])]}),e.jsx("td",{className:"p-2 border border-gray-300 text-right font-semibold",children:r[Re]||0})]},r.id||h)}):e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"p-4 text-center text-gray-500 border border-gray-300",children:"No hay pr谩cticas registradas."})})})]})]}),e.jsx("footer",{className:"mt-12 text-center text-xs text-gray-500",children:e.jsxs("p",{children:["Reporte generado el ",new Date().toLocaleDateString("es-ES"),". Este es un documento no oficial para seguimiento interno."]})})]}):e.jsx("div",{className:"p-8 font-sans text-center",children:e.jsx("p",{children:"Cargando datos del estudiante para el reporte..."})}),Fe=({onExit:a})=>e.jsxs("div",{className:"bg-amber-100 dark:bg-amber-900/40 border-b border-amber-200 dark:border-amber-800 text-amber-900 dark:text-amber-100 px-4 py-2 flex items-center justify-between shadow-sm sticky top-[60px] md:top-[80px] z-40",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"material-icons text-amber-600 dark:text-amber-400 !text-xl animate-pulse",children:"visibility"}),e.jsx("span",{className:"text-xs font-bold uppercase tracking-wide",children:"Modo Simulaci贸n: Est谩s actuando como este estudiante"})]}),a&&e.jsx("button",{onClick:a,className:"text-xs font-bold underline hover:text-amber-700 dark:hover:text-amber-300",children:"Salir"})]}),ls=()=>{const a=ua(),[s,d]=o.useState(!1),{studentDetails:r,studentAirtableId:h,lanzamientos:m,allLanzamientos:u,institutionAddressMap:f,enrollStudent:b,criterios:N,enrollmentMap:c,completedLanzamientoIds:j,informeTasks:g,finalizacionRequest:v}=$e(),x=o.useCallback(()=>{d(!0)},[]);return v?e.jsx("div",{className:"py-2 sm:py-6 animate-fade-in w-full max-w-7xl mx-auto",children:e.jsx(J,{status:v[G]||"Pendiente",requestDate:v[Z]||v.created_at||"",studentName:(r==null?void 0:r[$])||void 0})}):e.jsxs(U,{children:[s&&e.jsx("div",{className:"fixed inset-0 z-[1300] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4 animate-fade-in",children:e.jsxs("div",{className:"relative w-full max-w-2xl max-h-[90vh] overflow-y-auto bg-white dark:bg-slate-800 rounded-2xl shadow-2xl",children:[e.jsx("button",{onClick:()=>d(!1),className:"absolute top-4 right-4 z-10 p-2 bg-white/80 dark:bg-slate-700/80 rounded-full hover:bg-slate-100 dark:hover:bg-slate-600 text-slate-50 dark:text-slate-300 transition-colors shadow-sm backdrop-blur-sm",children:e.jsx("span",{className:"material-icons",children:"close"})}),e.jsx(He,{studentAirtableId:h,onClose:()=>d(!1)})]})}),e.jsx(Ve,{myEnrollments:c?Array.from(c.values()):[],allLanzamientos:u,informeTasks:g,lanzamientos:m,onNavigate:n=>a(`/student/${n==="inicio"?"":n}`),student:r,onInscribir:b.mutate,institutionAddressMap:f,enrollmentMap:c,completedLanzamientoIds:j,criterios:N,onOpenFinalization:x})]})},is=({user:a,activeTab:s,onTabChange:d,showExportButton:r=!1})=>{const{isSuperUserMode:h,isJefeMode:m,authenticatedUser:u}=ze(),[f,b]=o.useState(!1),[N,c]=o.useState(!1),[j,g]=o.useState(!1),[v,x]=o.useState(!1),{openSolicitudPPSModal:n}=oe(),{showToast:t}=ha(),O=ba(),C=a||u,A=h||m,{studentDetails:l,studentAirtableId:w,practicas:p,solicitudes:E,lanzamientos:M,allLanzamientos:H,institutionAddressMap:ce,institutionLogoMap:Ze,isLoading:F,isStudentLoading:Ge,isPracticasLoading:Je,error:xe,updateOrientation:me,updateInternalNotes:ue,updateNota:he,updateFechaFin:be,enrollStudent:pe,refetchAll:We,criterios:y,enrollmentMap:q,completedLanzamientoIds:ge,informeTasks:T,finalizacionRequest:k}=$e(),[Qe,Ke]=o.useState(r?"practicas":"inicio"),R=s??Qe,Y=d??Ke,B=(l==null?void 0:l[pa])||"",z=(l==null?void 0:l[$])||(C==null?void 0:C.nombre)||"Estudiante",{data:X}=ga({queryKey:["activeInstitutionsDB"],queryFn:()=>Oe.instituciones.getAll({fields:["nombre"]})}),Ne=()=>w||(C==null?void 0:C.id)||null,ee=o.useCallback(i=>{me.mutate(i,{onSuccess:()=>{b(!0),setTimeout(()=>b(!1),2e3)}})},[me]),fe=o.useCallback((i,S,L)=>{he.mutate({practicaId:i,nota:S,convocatoriaId:L})},[he]),D=o.useCallback(()=>{c(!0)},[]),Ye=o.useMemo(()=>{const i=new Set;return H.forEach(S=>{const L=S[V];L&&i.add(L.split(" - ")[0].trim())}),X&&X.forEach(S=>{S.nombre&&i.add(S.nombre.split(" - ")[0].trim())}),Array.from(i).sort((S,L)=>S.localeCompare(L))},[H,X]),je=Ue({mutationFn:async i=>{const S=Ne();if(!S)throw new Error("Error identificando al estudiante.");const L={[Pa]:S,[Da]:l==null?void 0:l[K],[Fa]:l==null?void 0:l[$],[Ta]:l==null?void 0:l[La],[Oa]:i.nombreInstitucion,[_a]:i.localidad,[ya]:i.direccion,[Aa]:i.emailInstitucion,[Sa]:i.telefonoInstitucion,[Ea]:i.referente,[wa]:i.tieneConvenio,[Ca]:i.tieneTutor,[Ia]:i.contactoTutor,[ka]:i.tipoPractica,[va]:i.descripcion,[Ma]:"Pendiente",[ja]:new Date().toISOString().split("T")[0]};await Oe.solicitudes.create(L)},onSuccess:()=>{t("Tu solicitud de PPS ha sido registrada.","success"),O.invalidateQueries({queryKey:["solicitudes"]})},onError:i=>t(`Error: ${i.message} `,"error")}),ve=o.useCallback(()=>g(!0),[]),Xe=o.useCallback(()=>{g(!1),n(async i=>{await je.mutateAsync(i)})},[n,je]),ae=o.useMemo(()=>e.jsx(U,{children:e.jsx(Ve,{myEnrollments:q?Array.from(q.values()):[],allLanzamientos:H,informeTasks:T,lanzamientos:M,onNavigate:i=>Y(i),student:l,onInscribir:pe.mutate,institutionAddressMap:ce,institutionLogoMap:Ze,enrollmentMap:q,completedLanzamientoIds:ge,criterios:y,onOpenFinalization:D})}),[q,H,T,M,l,pe.mutate,ce,ge,y,D,Y]),se=o.useMemo(()=>e.jsx(U,{children:e.jsx($a,{solicitudes:E,onCreateSolicitud:ve,onRequestFinalization:D,criterios:y,informeTasks:T})}),[E,ve,D,y,T]),ke=o.useCallback((i,S)=>{be.mutate({practicaId:i,fecha:S})},[be]),te=o.useMemo(()=>e.jsx(U,{children:e.jsx(Na,{practicas:p,handleNotaChange:fe,handleFechaFinChange:ke,isLoading:Je})}),[p,fe,ke]),re=o.useMemo(()=>e.jsx(U,{children:e.jsx(Ba,{studentDetails:l,isLoading:F,updateInternalNotes:ue})}),[l,F,ue]),ea=o.useMemo(()=>[{id:"inicio",label:"Inicio",icon:"home",content:ae},{id:"solicitudes",label:"Mis Solicitudes",icon:"list_alt",content:se,badge:E.length>0?E.length:void 0},{id:"practicas",label:"Mis Pr谩cticas",icon:"work_history",content:te,badge:p.length>0?p.length:void 0},{id:"profile",label:"Mi Perfil",icon:"person",content:re}],[ae,se,te,re,E.length,p.length]),aa=o.useMemo(()=>!F&&p.length===0&&E.length===0&&M.length===0&&T.length===0&&A&&!v,[F,p.length,E.length,M.length,T.length,A,v]);return Ge?e.jsx(Qa,{}):xe?e.jsx(Ka,{error:xe.message,onRetry:()=>We()}):k&&!A?e.jsx("div",{className:"py-2 sm:py-6 animate-fade-in w-full max-w-7xl mx-auto",children:e.jsx(J,{status:k[G]||"Pendiente",requestDate:k[Z]||k.created_at||"",studentName:z})}):aa?e.jsxs(e.Fragment,{children:[A&&e.jsx(Fe,{}),e.jsx("div",{className:"print-only",children:e.jsx(Le,{studentDetails:l,criterios:y,practicas:p})}),e.jsxs("div",{className:"no-print space-y-8 animate-fade-in-up mt-6",children:[e.jsx(W,{studentName:z,studentDetails:l,isLoading:!1}),e.jsx(le,{criterios:y,selectedOrientacion:B,handleOrientacionChange:ee,showSaveConfirmation:f,onRequestFinalization:D,informeTasks:T}),e.jsx(ie,{className:"border-slate-300/50 bg-slate-50/30",children:e.jsx(de,{icon:"search_off",title:"Sin Resultados",message:"No se encontr贸 informaci贸n para este estudiante.",action:e.jsx(fa,{onClick:()=>x(!0),icon:"input",variant:"secondary",children:"Gestionar / Inscribir"})})})]})]}):e.jsxs(e.Fragment,{children:[A&&e.jsx(Fe,{}),j&&e.jsx(Ha,{isOpen:j,onClose:()=>g(!1),onContinue:Xe,existingInstitutions:Ye}),N&&e.jsx("div",{className:"fixed inset-0 z-[1300] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4 animate-fade-in",children:e.jsxs("div",{className:"relative w-full max-w-2xl max-h-[90vh] overflow-y-auto bg-white dark:bg-slate-800 rounded-2xl shadow-2xl",children:[e.jsx("button",{onClick:()=>c(!1),className:"absolute top-4 right-4 z-10 p-2 bg-white/80 dark:bg-slate-700/80 rounded-full text-slate-50 shadow-sm backdrop-blur-sm",children:e.jsx("span",{className:"material-icons",children:"close"})}),e.jsx(He,{studentAirtableId:Ne(),onClose:()=>c(!1)})]})}),e.jsx("div",{className:"print-only",children:e.jsx(Le,{studentDetails:l,criterios:y,practicas:p})}),e.jsxs("div",{className:"hidden md:block no-print space-y-8 animate-fade-in-up mt-6",children:[e.jsx(W,{studentName:z,studentDetails:l,isLoading:F}),k&&e.jsx(J,{status:k[G]||"Pendiente",requestDate:k[Z]||k.created_at||""}),!k&&e.jsx(le,{criterios:y,selectedOrientacion:B,handleOrientacionChange:ee,showSaveConfirmation:f,onRequestFinalization:D,informeTasks:T}),e.jsx(qa,{tabs:ea,activeTabId:R,onTabChange:i=>Y(i)})]}),e.jsxs("div",{className:"md:hidden no-print space-y-8 animate-fade-in-up mt-4",children:[R==="inicio"&&e.jsxs(e.Fragment,{children:[e.jsx(W,{studentName:z,studentDetails:l,isLoading:F}),k&&e.jsx(J,{status:k[G]||"Pendiente",requestDate:k[Z]||k.created_at||""}),ae]}),R==="solicitudes"&&e.jsx(e.Fragment,{children:se}),R==="practicas"&&e.jsxs(e.Fragment,{children:[!k&&e.jsx(le,{criterios:y,selectedOrientacion:B,handleOrientacionChange:ee,showSaveConfirmation:f,onRequestFinalization:D,informeTasks:T}),te]}),R==="profile"&&e.jsx(ie,{children:re})]}),r&&e.jsx(Wa,{practicas:p,criterios:y,selectedOrientacion:B,studentNameForPanel:z,studentDetails:l,isLoading:F})]})};export{ls as StudentHome,Na as StudentPracticas,$a as StudentSolicitudes,is as default};
